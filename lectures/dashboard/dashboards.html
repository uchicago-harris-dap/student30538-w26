<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="dashboards_files/libs/clipboard/clipboard.min.js"></script>
<script src="dashboards_files/libs/quarto-html/tabby.min.js"></script>
<script src="dashboards_files/libs/quarto-html/popper.min.js"></script>
<script src="dashboards_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="dashboards_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dashboards_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="dashboards_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.31">

  <meta name="author" content="Peter Ganong and Maggie Shi">
  <meta name="dcterms.date" content="2025-12-07">
  <title>Dashboards (Lecture XXX)</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="dashboards_files/libs/revealjs/dist/theme/quarto-f563837468303362081e247dddd440d0.css">
  <link href="dashboards_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="dashboards_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Dashboards (Lecture XXX)</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Peter Ganong and Maggie Shi 
</div>
</div>
</div>

  <p class="date">December 7, 2025</p>
</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>
<!--
## Table of contents

::: {.toc}

:::-->
</section>
<section id="from-a-static-process" class="slide level2">
<h2>From A Static Process</h2>

<img data-src="pictures/process_1.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"><aside class="notes">
<ul>
<li>Review table of contents (does not render as a separate slide)</li>
<li>When you submit a problem set or read a paper, It usually is imagined to follow a process like this</li>
<li>Number one you write the code</li>
<li>number two you run the code</li>
<li>number three the recipient looks like at output.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_2.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"><aside class="notes">
<ul>
<li>Except that for anyone who has spent time at the Harris School or in another research environment, you know that this is not actually anything like how research happens.</li>
<li>In practice after you look at the output, you interact with the output and then you go back and you change the code and you run the code again and you look at the output again.</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process-1" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_3.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"><ul>
<li>When you analyze a dataset, your process looks a lot more like the dynamic one than the static one. Dashboards allow someone who does not code to do a limited version of the same process you go through.</li>
</ul>
<aside class="notes">
<p>What dashboards to do is they enable someone who does not write code to do a small scale version of the skill that you already have, which is to manipulate the code and re-examine the output.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="to-a-dynamic-process-2" class="slide level2">
<h2>To A Dynamic Process</h2>

<img data-src="pictures/process_4.png" class="quarto-figure quarto-figure-center r-stretch" style="width:70.0%"><aside class="notes">
<p>The other thing dashboard is that they need your code to be run not just on your computer but also run on a personal web server.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="other-benefits-of-dashboards" class="slide level2">
<h2>Other benefits of dashboards</h2>
<ul>
<li>There are two other major benefits of dashboards which we will not spend time on in class, but you should also know about
<ul>
<li>Consolidated information: aggregate data from various sources into one unified interface</li>
<li>Real-time data metrics: dynamic view based on automatically-updated data feed</li>
</ul></li>
<li><em>(Impressive: they are a great way to flex your data skills for your portfolio!)</em></li>
</ul>
</section>
<section id="where-we-are-going" class="slide level2">
<h2>Where we are going</h2>
<p><a href="http://uchicago-harris-dap-dashboards-4.streamlit.app/">http://uchicago-harris-dap-dashboards-4.streamlit.app/</a></p>
<aside class="notes">
<p>Poke around here a bit to clarify that this is what we will be able to do by the end of the lecture note</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dashboards-promises-and-pitfalls" class="slide level2">
<h2>Dashboards: Promises and Pitfalls</h2>
<p>When Professor Ganong worked in the Mayor‚Äôs Office in Boston, the mayor asked for every single department to suggest metrics for a dashboard. The mayor put a TV in his office so that the dashboards would be displayed at all times.</p>
<p>Discussion questions:</p>
<ol type="1">
<li>What are examples of data that a city would benefit from tracking with a dashboard?</li>
<li>What are examples of data where putting it on a dashboard might inadvertently lead to poor management or create bad incentives for workers?</li>
</ol>
<aside class="notes">
<ol type="1">
<li><p>Clearance rate for reported crimes, School attendance, Number of snow plows in operation Number of overdoses</p></li>
<li><p>Number of closed citizen complaints. Not good because it creates an incentive to close complaints rapidly rather than to make sure that they are actually solved. Number of miles covered by street sweepers. Not good because it incentivizes covering ground rather than doubling back when something is missed to make sure it is actually cleaned. Number of cars towed. Not clear if we want this metric to be high or low, depends on the context.</p></li>
</ol>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="streamlit" class="slide level2" style="font-size: 0.8em">
<h2>Streamlit</h2>
<p>Streamlit‚Äôs is designed for data scientists who want to share analyses without needing front-end development skills. Beyond being easy to use, we chose to teach Streamlit for a few reasons:</p>
<ol type="1">
<li>Native to Python, works well with existing Python tools (e.g.&nbsp;Altair)</li>
<li>All its features are free (so long as you are making public dashboards)</li>
<li>Open source: <a href="https://github.com/streamlit/streamlit">https://github.com/streamlit/streamlit</a></li>
</ol>
<p>These lecture slides draw on examples and text from <a href="https://docs.streamlit.io">https://docs.streamlit.io</a>.</p>
<p>Caveat: Streamlit is that it is best for prototyping (not computationally efficient for many users). We will talk more at the end of the lecture about how you will use streamlit and other tools going forward.</p>
<aside class="notes">
<p>It is most useful for creating a prototype. If someone decides it is needs to be accessed by many users or needs to be built on top of secure data it will be replicated using a different dashboarding tool. This is very common. When professor Ganong worked at the city of Boston, everything that was going to be used on a continuing basis was transferred to another more stable platform.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="introduction-summary" class="slide level2">
<h2>Introduction: summary</h2>
<ul>
<li>Dashboards let non-coders interact with data</li>
<li>Introduce <code>streamlit</code></li>
<li>Note on process: this is our first year teaching this lecture note so we are highly uncertain how long it will take (both each slide and the lecture overall)</li>
</ul>
<aside class="notes">
<p>Review table of contents for the rest of lecture</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="dashboards-as-websites" class="title-slide slide level1 center">
<h1>Dashboards as websites</h1>

</section>
<section id="my-first-dashboard" class="slide level2">
<h2>My first dashboard</h2>
<div id="3bb433f0" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb1-2"><a href=""></a>st.write(<span class="st">"""</span></span>
<span id="cb1-3"><a href=""></a><span class="st"># My first app</span></span>
<span id="cb1-4"><a href=""></a><span class="st">Hello *world!*</span></span>
<span id="cb1-5"><a href=""></a><span class="st">"""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this lecture: <code>$</code> means run at the terminal (on Macs the prefix is <code>%</code>). You do not need to type <code>$</code>.</p>
<ul>
<li><code>$ pip install streamlit</code></li>
<li><code>$ streamlit run 1/hello_world_1.py</code></li>
</ul>
<aside class="notes">
<p>Re-review the table of contents</p>
<p>We will start with the most simple possible dashboard. If you want to run this code, you can do just two steps first to install streamlit by running this first line of code at the terminal and then you run the script again at the command line.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- MS to PG: a roadmap here would be really helpful. PG to MS do you mean for this section or for this lecture as a whole? I already had a speaker note at the very very beginning (on the first slide) saying to review the table of contents. But clearly that wasn't enough. I now added a note which says "re-review the table of contents". But maybe there's something else which doesn't correspond to either of these which would be more helpful? 

MS to GGG: ah, I think I missed that there is supposed to be a table of contents slide that didn't render. Re-reviewing ToC at this point would still be helpful, though!-->
</section>
<section id="my-first-dashboard-two-ways-to-display" class="slide level2">
<h2>My first dashboard ‚Äì two ways to display</h2>
<ol type="1">
<li><strong>Local</strong> Create a server on your computer. Access from your web browser (and no one else‚Äôs).</li>
<li><strong>Online</strong> Create a server in the cloud. Access from any web browser.</li>
</ol>
<!-- MS to GGG: I would add a note on 1 that says something like "this is what you just did on the last slide" -->
</section>
<section id="my-first-dashboard-putting-it-online" class="slide level2">
<h2>My first dashboard ‚Äì putting it online</h2>
<ul>
<li>Prep ‚Äì <a href="https://github.com/uchicago-harris-dap/dashboards">https://github.com/uchicago-harris-dap/dashboards</a>
<ul>
<li>Create a separate repo just for your dashboards.</li>
<li>Be sure it is public.</li>
<li>Push &lt;!‚Äì MS to GGG: just tried deploying this and was successful (except 3/Hello.py) Some notes based on that:</li>
</ul></li>
</ul>
<ol type="1">
<li>add a bullet here that you have to connect your github account to streamlit community cloud if it‚Äôs your first time deploying something</li>
<li>I‚Äôd also add a bullet here that you have to run <code>streamlit run [dashboardname].py</code> locally to get to the page with the Deploy Now button (unless I‚Äôm missing something, I think this is step 3 for deploying?)</li>
<li>Discuss live that you deploy someone else‚Äôs dashboard by cloning their (public) repo onto your own computer, running it locally, and then deploying from there. ‚Äì&gt;</li>
</ol>
<ul>
<li>Three clicks: Deploy -&gt; Deploy Now (under Streamlit Community Cloud) -&gt; Deploy (with pre-filled repo, branch, and file names).</li>
<li>Workflow: Streamlit does <strong>not</strong> actually deploy the script which is stored on your computed. Instead, it reads the script which is pushed to a public repo and deploys that.</li>
</ul>
<p><a href="http://uchicago-harris-dap-dashboards-1.streamlit.app/">http://uchicago-harris-dap-dashboards-1.streamlit.app/</a></p>
<aside class="notes">
<p>Comment for maggie: You might wonder how it is possible that we will be live-deploying the same script multiple times (once every class). The answer is that each time we are just over-writing the existing deployment.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="my-second-dashboard" class="slide level2">
<h2>My second dashboard</h2>
<ul>
<li><code>$ streamlit run 2/hello_world_2_local.py</code></li>
<li>Uncomment <code>st.altair_chart(chart_to_show)</code>. Save. Show detection of file change.
<ul>
<li>Fun fact: streamlit will automatically figure out how to print various data types to the web so you also can instead just write <code>chart_to_show</code>.</li>
</ul></li>
<li>This is the normal workflow for building a streamlit dashboard. Update code. Save. Re-run in browser. Once you are happy, then you deploy.</li>
<li><a href="http://uchicago-harris-dap-dashboards-2.streamlit.app/">http://uchicago-harris-dap-dashboards-2.streamlit.app/</a></li>
</ul>
<aside class="notes">
<p>Next I will show slightly more sophisticated script (SCREEN: hello_world_2_local.py)</p>
<p>In this script, I‚Äôm going to need the Seattle weather file that you used earlier and visualization and then I‚Äôm going to make a chart out of it.</p>
<p>Point to pandas command.</p>
<p>Point to altair command.</p>
<p>SCREEN: Slide. Implement the steps described in the slide.</p>
<p>For the rest of this lecture, we aren‚Äôt going to do any more live deployments (creates unnecessary live debugging) so instead just visit the deployed dashboard on the web.</p>
<p>SCREEN: <a href="http://uchicago-harris-dap-dashboards-2.streamlit.app/">http://uchicago-harris-dap-dashboards-2.streamlit.app/</a>. On that page, review ‚Äúmanage app‚Äù, ‚Äúrecord a screencast‚Äù</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section></section>
<section>
<section id="interactive-dashboards" class="title-slide slide level1 center">
<h1>Interactive dashboards</h1>

</section>
<section id="roadmap" class="slide level2">
<h2>Roadmap</h2>
<p>Dashboard 3. Multipage.</p>
<p>Dashboard 4. Uber pickups. ‚ÄúClassic‚Äù streamlit dashboard.</p>
</section>
<section id="dashboard-3-roadmap" class="slide level2">
<h2>Dashboard 3 roadmap</h2>
<ol type="1">
<li>Homepage with dropdown menu</li>
<li>Plotting demo with button</li>
<li>Dataframe demo with selection box and table</li>
<li>Mapping demo with checkboxes</li>
</ol>
<p>Preview <a href="http://uchicago-harris-dap-dashboards-3b.streamlit.app/">http://uchicago-harris-dap-dashboards-3b.streamlit.app/</a></p>
</section>
<section id="dashboard-3-homepage-review-code" class="slide level2" style="font-size: 0.8em">
<h2>Dashboard 3 Homepage Review code</h2>
<ul>
<li>Review <code>intro()</code> function</li>
<li>Dropdown bar created via <code>st.sidebar.selectbox("Choose a demo", page_names_to_funcs.keys())</code></li>
</ul>
<div id="6801780d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb2-2"><a href=""></a></span>
<span id="cb2-3"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Multipage Demo"</span>)</span>
<span id="cb2-4"><a href=""></a></span>
<span id="cb2-5"><a href=""></a></span>
<span id="cb2-6"><a href=""></a><span class="kw">def</span> intro():</span>
<span id="cb2-7"><a href=""></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb2-8"><a href=""></a></span>
<span id="cb2-9"><a href=""></a>    st.write(<span class="st">"# Welcome to Streamlit! üëã"</span>)</span>
<span id="cb2-10"><a href=""></a>    st.sidebar.success(<span class="st">"Select a demo above."</span>)</span>
<span id="cb2-11"><a href=""></a></span>
<span id="cb2-12"><a href=""></a>    st.markdown(</span>
<span id="cb2-13"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb2-14"><a href=""></a><span class="st">        Streamlit is an open-source app framework built specifically for</span></span>
<span id="cb2-15"><a href=""></a><span class="st">        Machine Learning and Data Science projects.</span></span>
<span id="cb2-16"><a href=""></a></span>
<span id="cb2-17"><a href=""></a><span class="st">        **üëà Select a demo from the dropdown on the left** to see some examples</span></span>
<span id="cb2-18"><a href=""></a><span class="st">        of what Streamlit can do!</span></span>
<span id="cb2-19"><a href=""></a></span>
<span id="cb2-20"><a href=""></a><span class="st">        ### Want to learn more?</span></span>
<span id="cb2-21"><a href=""></a></span>
<span id="cb2-22"><a href=""></a><span class="st">        - Check out [streamlit.io](https://streamlit.io)</span></span>
<span id="cb2-23"><a href=""></a><span class="st">        - Jump into our [documentation](https://docs.streamlit.io)</span></span>
<span id="cb2-24"><a href=""></a><span class="st">        - Ask a question in our [community</span></span>
<span id="cb2-25"><a href=""></a><span class="st">          forums](https://discuss.streamlit.io)</span></span>
<span id="cb2-26"><a href=""></a></span>
<span id="cb2-27"><a href=""></a><span class="st">        ### See more complex demos</span></span>
<span id="cb2-28"><a href=""></a></span>
<span id="cb2-29"><a href=""></a><span class="st">        - Explore a [New York City rideshare dataset](https://github.com/streamlit/demo-uber-nyc-pickups)</span></span>
<span id="cb2-30"><a href=""></a><span class="st">    """</span></span>
<span id="cb2-31"><a href=""></a>    )</span>
<span id="cb2-32"><a href=""></a></span>
<span id="cb2-33"><a href=""></a><span class="kw">def</span> mapping_demo():</span>
<span id="cb2-34"><a href=""></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb2-35"><a href=""></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-36"><a href=""></a>    <span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb2-37"><a href=""></a></span>
<span id="cb2-38"><a href=""></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb2-39"><a href=""></a></span>
<span id="cb2-40"><a href=""></a>    st.markdown(<span class="ss">f"# </span><span class="sc">{</span><span class="bu">list</span>(page_names_to_funcs.keys())[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-41"><a href=""></a>    st.write(</span>
<span id="cb2-42"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb2-43"><a href=""></a><span class="st">        This demo shows how to use</span></span>
<span id="cb2-44"><a href=""></a><span class="st">[`st.pydeck_chart`](https://docs.streamlit.io/develop/api-reference/charts/st.pydeck_chart)</span></span>
<span id="cb2-45"><a href=""></a><span class="st">to display geospatial data.</span></span>
<span id="cb2-46"><a href=""></a><span class="st">"""</span></span>
<span id="cb2-47"><a href=""></a>    )</span>
<span id="cb2-48"><a href=""></a></span>
<span id="cb2-49"><a href=""></a>    <span class="at">@st.cache_data</span></span>
<span id="cb2-50"><a href=""></a>    <span class="kw">def</span> from_data_file(filename):</span>
<span id="cb2-51"><a href=""></a>        url <span class="op">=</span> (</span>
<span id="cb2-52"><a href=""></a>            <span class="st">"http://raw.githubusercontent.com/streamlit/"</span></span>
<span id="cb2-53"><a href=""></a>            <span class="st">"example-data/master/hello/v1/</span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> filename</span>
<span id="cb2-54"><a href=""></a>        )</span>
<span id="cb2-55"><a href=""></a>        <span class="cf">return</span> pd.read_json(url)</span>
<span id="cb2-56"><a href=""></a></span>
<span id="cb2-57"><a href=""></a>    <span class="cf">try</span>:</span>
<span id="cb2-58"><a href=""></a>        ALL_LAYERS <span class="op">=</span> {</span>
<span id="cb2-59"><a href=""></a>            <span class="st">"Bike Rentals"</span>: pdk.Layer(</span>
<span id="cb2-60"><a href=""></a>                <span class="st">"HexagonLayer"</span>,</span>
<span id="cb2-61"><a href=""></a>                data<span class="op">=</span>from_data_file(<span class="st">"bike_rental_stats.json"</span>),</span>
<span id="cb2-62"><a href=""></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb2-63"><a href=""></a>                radius<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb2-64"><a href=""></a>                elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb2-65"><a href=""></a>                elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb2-66"><a href=""></a>                extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-67"><a href=""></a>            ),</span>
<span id="cb2-68"><a href=""></a>            <span class="st">"Bart Stop Exits"</span>: pdk.Layer(</span>
<span id="cb2-69"><a href=""></a>                <span class="st">"ScatterplotLayer"</span>,</span>
<span id="cb2-70"><a href=""></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb2-71"><a href=""></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb2-72"><a href=""></a>                get_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb2-73"><a href=""></a>                get_radius<span class="op">=</span><span class="st">"[exits]"</span>,</span>
<span id="cb2-74"><a href=""></a>                radius_scale<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb2-75"><a href=""></a>            ),</span>
<span id="cb2-76"><a href=""></a>            <span class="st">"Bart Stop Names"</span>: pdk.Layer(</span>
<span id="cb2-77"><a href=""></a>                <span class="st">"TextLayer"</span>,</span>
<span id="cb2-78"><a href=""></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb2-79"><a href=""></a>                get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb2-80"><a href=""></a>                get_text<span class="op">=</span><span class="st">"name"</span>,</span>
<span id="cb2-81"><a href=""></a>                get_color<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">200</span>],</span>
<span id="cb2-82"><a href=""></a>                get_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb2-83"><a href=""></a>                get_alignment_baseline<span class="op">=</span><span class="st">"'bottom'"</span>,</span>
<span id="cb2-84"><a href=""></a>            ),</span>
<span id="cb2-85"><a href=""></a>            <span class="st">"Outbound Flow"</span>: pdk.Layer(</span>
<span id="cb2-86"><a href=""></a>                <span class="st">"ArcLayer"</span>,</span>
<span id="cb2-87"><a href=""></a>                data<span class="op">=</span>from_data_file(<span class="st">"bart_path_stats.json"</span>),</span>
<span id="cb2-88"><a href=""></a>                get_source_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb2-89"><a href=""></a>                get_target_position<span class="op">=</span>[<span class="st">"lon2"</span>, <span class="st">"lat2"</span>],</span>
<span id="cb2-90"><a href=""></a>                get_source_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb2-91"><a href=""></a>                get_target_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb2-92"><a href=""></a>                auto_highlight<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-93"><a href=""></a>                width_scale<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span id="cb2-94"><a href=""></a>                get_width<span class="op">=</span><span class="st">"outbound"</span>,</span>
<span id="cb2-95"><a href=""></a>                width_min_pixels<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb2-96"><a href=""></a>                width_max_pixels<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb2-97"><a href=""></a>            ),</span>
<span id="cb2-98"><a href=""></a>        }</span>
<span id="cb2-99"><a href=""></a>        st.sidebar.markdown(<span class="st">"### Map Layers"</span>)</span>
<span id="cb2-100"><a href=""></a>        selected_layers <span class="op">=</span> [</span>
<span id="cb2-101"><a href=""></a>            layer</span>
<span id="cb2-102"><a href=""></a>            <span class="cf">for</span> layer_name, layer <span class="kw">in</span> ALL_LAYERS.items()</span>
<span id="cb2-103"><a href=""></a>            <span class="cf">if</span> st.sidebar.checkbox(layer_name, <span class="va">True</span>)</span>
<span id="cb2-104"><a href=""></a>        ]</span>
<span id="cb2-105"><a href=""></a>        <span class="cf">if</span> selected_layers:</span>
<span id="cb2-106"><a href=""></a>            st.pydeck_chart(</span>
<span id="cb2-107"><a href=""></a>                pdk.Deck(</span>
<span id="cb2-108"><a href=""></a>                    map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb2-109"><a href=""></a>                    initial_view_state<span class="op">=</span>{</span>
<span id="cb2-110"><a href=""></a>                        <span class="st">"latitude"</span>: <span class="fl">37.76</span>,</span>
<span id="cb2-111"><a href=""></a>                        <span class="st">"longitude"</span>: <span class="op">-</span><span class="fl">122.4</span>,</span>
<span id="cb2-112"><a href=""></a>                        <span class="st">"zoom"</span>: <span class="dv">11</span>,</span>
<span id="cb2-113"><a href=""></a>                        <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb2-114"><a href=""></a>                    },</span>
<span id="cb2-115"><a href=""></a>                    layers<span class="op">=</span>selected_layers,</span>
<span id="cb2-116"><a href=""></a>                )</span>
<span id="cb2-117"><a href=""></a>            )</span>
<span id="cb2-118"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb2-119"><a href=""></a>            st.error(<span class="st">"Please choose at least one layer above."</span>)</span>
<span id="cb2-120"><a href=""></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb2-121"><a href=""></a>        st.error(</span>
<span id="cb2-122"><a href=""></a>            <span class="st">"""</span></span>
<span id="cb2-123"><a href=""></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb2-124"><a href=""></a></span>
<span id="cb2-125"><a href=""></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb2-126"><a href=""></a><span class="st">        """</span></span>
<span id="cb2-127"><a href=""></a>            <span class="op">%</span> e.reason</span>
<span id="cb2-128"><a href=""></a>        )</span>
<span id="cb2-129"><a href=""></a></span>
<span id="cb2-130"><a href=""></a><span class="kw">def</span> plotting_demo():</span>
<span id="cb2-131"><a href=""></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb2-132"><a href=""></a>    <span class="im">import</span> time</span>
<span id="cb2-133"><a href=""></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-134"><a href=""></a></span>
<span id="cb2-135"><a href=""></a>    st.markdown(<span class="ss">f'# </span><span class="sc">{</span><span class="bu">list</span>(page_names_to_funcs.keys())[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb2-136"><a href=""></a>    st.write(</span>
<span id="cb2-137"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb2-138"><a href=""></a><span class="st">        This demo illustrates a combination of plotting and animation with</span></span>
<span id="cb2-139"><a href=""></a><span class="st">Streamlit. We're generating a bunch of random numbers in a loop for around</span></span>
<span id="cb2-140"><a href=""></a><span class="st">5 seconds. Enjoy!</span></span>
<span id="cb2-141"><a href=""></a><span class="st">"""</span></span>
<span id="cb2-142"><a href=""></a>    )</span>
<span id="cb2-143"><a href=""></a></span>
<span id="cb2-144"><a href=""></a>    progress_bar <span class="op">=</span> st.sidebar.progress(<span class="dv">0</span>)</span>
<span id="cb2-145"><a href=""></a>    status_text <span class="op">=</span> st.sidebar.empty()</span>
<span id="cb2-146"><a href=""></a>    last_rows <span class="op">=</span> np.random.randn(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb2-147"><a href=""></a>    chart <span class="op">=</span> st.line_chart(last_rows)</span>
<span id="cb2-148"><a href=""></a></span>
<span id="cb2-149"><a href=""></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">101</span>):</span>
<span id="cb2-150"><a href=""></a>        new_rows <span class="op">=</span> last_rows[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">+</span> np.random.randn(<span class="dv">5</span>, <span class="dv">1</span>).cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb2-151"><a href=""></a>        status_text.text(<span class="st">"</span><span class="sc">%i%%</span><span class="st"> Complete"</span> <span class="op">%</span> i)</span>
<span id="cb2-152"><a href=""></a>        chart.add_rows(new_rows)</span>
<span id="cb2-153"><a href=""></a>        progress_bar.progress(i)</span>
<span id="cb2-154"><a href=""></a>        last_rows <span class="op">=</span> new_rows</span>
<span id="cb2-155"><a href=""></a>        time.sleep(<span class="fl">0.05</span>)</span>
<span id="cb2-156"><a href=""></a></span>
<span id="cb2-157"><a href=""></a>    progress_bar.empty()</span>
<span id="cb2-158"><a href=""></a></span>
<span id="cb2-159"><a href=""></a>    <span class="co"># Streamlit widgets automatically run the script from top to bottom. Since</span></span>
<span id="cb2-160"><a href=""></a>    <span class="co"># this button is not connected to any other logic, it just causes a plain</span></span>
<span id="cb2-161"><a href=""></a>    <span class="co"># rerun.</span></span>
<span id="cb2-162"><a href=""></a>    st.button(<span class="st">"Re-run"</span>)</span>
<span id="cb2-163"><a href=""></a></span>
<span id="cb2-164"><a href=""></a></span>
<span id="cb2-165"><a href=""></a><span class="kw">def</span> data_frame_demo():</span>
<span id="cb2-166"><a href=""></a>    <span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb2-167"><a href=""></a>    <span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-168"><a href=""></a>    <span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb2-169"><a href=""></a></span>
<span id="cb2-170"><a href=""></a>    <span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb2-171"><a href=""></a></span>
<span id="cb2-172"><a href=""></a>    st.markdown(<span class="ss">f"# </span><span class="sc">{</span><span class="bu">list</span>(page_names_to_funcs.keys())[<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-173"><a href=""></a>    st.write(</span>
<span id="cb2-174"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb2-175"><a href=""></a><span class="st">        This demo shows how to use `st.write` to visualize Pandas DataFrames.</span></span>
<span id="cb2-176"><a href=""></a></span>
<span id="cb2-177"><a href=""></a><span class="st">(Data courtesy of the [UN Data Explorer](http://data.un.org/Explorer.aspx).)</span></span>
<span id="cb2-178"><a href=""></a><span class="st">"""</span></span>
<span id="cb2-179"><a href=""></a>    )</span>
<span id="cb2-180"><a href=""></a></span>
<span id="cb2-181"><a href=""></a>    <span class="at">@st.cache_data</span></span>
<span id="cb2-182"><a href=""></a>    <span class="kw">def</span> get_UN_data():</span>
<span id="cb2-183"><a href=""></a>        AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb2-184"><a href=""></a>        df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb2-185"><a href=""></a>        <span class="cf">return</span> df.set_index(<span class="st">"Region"</span>)</span>
<span id="cb2-186"><a href=""></a></span>
<span id="cb2-187"><a href=""></a>    <span class="cf">try</span>:</span>
<span id="cb2-188"><a href=""></a>        df <span class="op">=</span> get_UN_data()</span>
<span id="cb2-189"><a href=""></a>        countries <span class="op">=</span> st.multiselect(</span>
<span id="cb2-190"><a href=""></a>            <span class="st">"Choose countries"</span>, <span class="bu">list</span>(df.index), [<span class="st">"China"</span>, <span class="st">"United States of America"</span>]</span>
<span id="cb2-191"><a href=""></a>        )</span>
<span id="cb2-192"><a href=""></a>        <span class="cf">if</span> <span class="kw">not</span> countries:</span>
<span id="cb2-193"><a href=""></a>            st.error(<span class="st">"Please select at least one country."</span>)</span>
<span id="cb2-194"><a href=""></a>        <span class="cf">else</span>:</span>
<span id="cb2-195"><a href=""></a>            data <span class="op">=</span> df.loc[countries]</span>
<span id="cb2-196"><a href=""></a>            data <span class="op">/=</span> <span class="fl">1000000.0</span></span>
<span id="cb2-197"><a href=""></a>            st.write(<span class="st">"### Gross Agricultural Production ($B)"</span>, data.sort_index())</span>
<span id="cb2-198"><a href=""></a></span>
<span id="cb2-199"><a href=""></a>            data <span class="op">=</span> data.T.reset_index()</span>
<span id="cb2-200"><a href=""></a>            data <span class="op">=</span> pd.melt(data, id_vars<span class="op">=</span>[<span class="st">"index"</span>]).rename(</span>
<span id="cb2-201"><a href=""></a>                columns<span class="op">=</span>{<span class="st">"index"</span>: <span class="st">"year"</span>, <span class="st">"value"</span>: <span class="st">"Gross Agricultural Product ($B)"</span>}</span>
<span id="cb2-202"><a href=""></a>            )</span>
<span id="cb2-203"><a href=""></a>            chart <span class="op">=</span> (</span>
<span id="cb2-204"><a href=""></a>                alt.Chart(data)</span>
<span id="cb2-205"><a href=""></a>                .mark_area(opacity<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb2-206"><a href=""></a>                .encode(</span>
<span id="cb2-207"><a href=""></a>                    x<span class="op">=</span><span class="st">"year:T"</span>,</span>
<span id="cb2-208"><a href=""></a>                    y<span class="op">=</span>alt.Y(<span class="st">"Gross Agricultural Product ($B):Q"</span>, stack<span class="op">=</span><span class="va">None</span>),</span>
<span id="cb2-209"><a href=""></a>                    color<span class="op">=</span><span class="st">"Region:N"</span>,</span>
<span id="cb2-210"><a href=""></a>                )</span>
<span id="cb2-211"><a href=""></a>            )</span>
<span id="cb2-212"><a href=""></a>            st.altair_chart(chart, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb2-213"><a href=""></a>    <span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb2-214"><a href=""></a>        st.error(</span>
<span id="cb2-215"><a href=""></a>            <span class="st">"""</span></span>
<span id="cb2-216"><a href=""></a><span class="st">            **This demo requires internet access.**</span></span>
<span id="cb2-217"><a href=""></a></span>
<span id="cb2-218"><a href=""></a><span class="st">            Connection error: </span><span class="sc">%s</span></span>
<span id="cb2-219"><a href=""></a><span class="st">        """</span></span>
<span id="cb2-220"><a href=""></a>            <span class="op">%</span> e.reason</span>
<span id="cb2-221"><a href=""></a>        )</span>
<span id="cb2-222"><a href=""></a></span>
<span id="cb2-223"><a href=""></a>page_names_to_funcs <span class="op">=</span> {</span>
<span id="cb2-224"><a href=""></a>    <span class="st">"‚Äî"</span>: intro,</span>
<span id="cb2-225"><a href=""></a>    <span class="st">"Plotting Demo"</span>: plotting_demo,</span>
<span id="cb2-226"><a href=""></a>    <span class="st">"Mapping Demo"</span>: mapping_demo,</span>
<span id="cb2-227"><a href=""></a>    <span class="st">"DataFrame Demo"</span>: data_frame_demo</span>
<span id="cb2-228"><a href=""></a>}</span>
<span id="cb2-229"><a href=""></a></span>
<span id="cb2-230"><a href=""></a>demo_name <span class="op">=</span> st.sidebar.selectbox(<span class="st">"Choose a demo"</span>, page_names_to_funcs.keys())</span>
<span id="cb2-231"><a href=""></a>page_names_to_funcs[demo_name]()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-taking-input" class="slide level2">
<h2>Feature: taking input</h2>
<ul>
<li>Streamlit has a huge number of different ways to take <a href="https://docs.streamlit.io/develop/api-reference/widgets">input</a>. In this lecture you will see
<ul>
<li><code>st.button()</code></li>
<li><code>st.checkbox()</code></li>
<li><code>st.slider()</code></li>
<li><code>st.selectbox()</code></li>
</ul></li>
</ul>
</section>
<section id="example-3-plotting-demo" class="slide level2" style="font-size: 0.8em">
<h2>Example 3 plotting demo</h2>
<ul>
<li>Use <code>st</code> commands to set up page</li>
<li>Set up blank <code>progress_bar</code>, <code>status_text</code>, <code>chart</code> (writes Vega-Lite for us)</li>
<li>Loop to generate random numbers</li>
</ul>
<div id="051775ed" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb3-2"><a href=""></a><span class="im">import</span> time</span>
<span id="cb3-3"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href=""></a></span>
<span id="cb3-5"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Plotting Demo"</span>, page_icon<span class="op">=</span><span class="st">"üìà"</span>)</span>
<span id="cb3-6"><a href=""></a></span>
<span id="cb3-7"><a href=""></a>st.markdown(<span class="st">"# Plotting Demo"</span>)</span>
<span id="cb3-8"><a href=""></a>st.sidebar.header(<span class="st">"Plotting Demo"</span>)</span>
<span id="cb3-9"><a href=""></a>st.write(</span>
<span id="cb3-10"><a href=""></a>    <span class="st">"""This demo illustrates a combination of plotting and animation with</span></span>
<span id="cb3-11"><a href=""></a><span class="st">Streamlit. We're generating a bunch of random numbers in a loop for around</span></span>
<span id="cb3-12"><a href=""></a><span class="st">5 seconds. Enjoy!"""</span></span>
<span id="cb3-13"><a href=""></a>)</span>
<span id="cb3-14"><a href=""></a></span>
<span id="cb3-15"><a href=""></a>progress_bar <span class="op">=</span> st.sidebar.progress(<span class="dv">0</span>)</span>
<span id="cb3-16"><a href=""></a>status_text <span class="op">=</span> st.sidebar.empty()</span>
<span id="cb3-17"><a href=""></a>last_rows <span class="op">=</span> np.random.randn(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb3-18"><a href=""></a>chart <span class="op">=</span> st.line_chart(last_rows)</span>
<span id="cb3-19"><a href=""></a></span>
<span id="cb3-20"><a href=""></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">101</span>):</span>
<span id="cb3-21"><a href=""></a>    new_rows <span class="op">=</span> last_rows[<span class="op">-</span><span class="dv">1</span>, :] <span class="op">+</span> np.random.randn(<span class="dv">5</span>, <span class="dv">1</span>).cumsum(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-22"><a href=""></a>    status_text.text(<span class="st">"</span><span class="sc">%i%%</span><span class="st"> Complete"</span> <span class="op">%</span> i)</span>
<span id="cb3-23"><a href=""></a>    chart.add_rows(new_rows)</span>
<span id="cb3-24"><a href=""></a>    progress_bar.progress(i)</span>
<span id="cb3-25"><a href=""></a>    last_rows <span class="op">=</span> new_rows</span>
<span id="cb3-26"><a href=""></a>    time.sleep(<span class="fl">0.05</span>)</span>
<span id="cb3-27"><a href=""></a></span>
<span id="cb3-28"><a href=""></a>progress_bar.empty()</span>
<span id="cb3-29"><a href=""></a></span>
<span id="cb3-30"><a href=""></a><span class="co"># Streamlit widgets automatically run the script from top to bottom. Since</span></span>
<span id="cb3-31"><a href=""></a><span class="co"># this button is not connected to any other logic, it just causes a plain</span></span>
<span id="cb3-32"><a href=""></a><span class="co"># rerun.</span></span>
<span id="cb3-33"><a href=""></a>st.button(<span class="st">"Re-run"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>In the static visualization lectures we mentioned vega-lite without explaining really how you would use it. Now you can see how it is used which is that Streamlit is going to write Vega-Lite for us</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="dataframe-demo-data-preview" class="slide level2">
<h2>DataFrame demo data preview</h2>
<div id="fef86989" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb4-2"><a href=""></a><span class="kw">def</span> get_UN_data():</span>
<span id="cb4-3"><a href=""></a>    AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb4-4"><a href=""></a>    df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb4-5"><a href=""></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b9a81adf" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href=""></a>get_UN_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Region</th>
<th data-quarto-table-cell-role="th">1961</th>
<th data-quarto-table-cell-role="th">1962</th>
<th data-quarto-table-cell-role="th">1963</th>
<th data-quarto-table-cell-role="th">1964</th>
<th data-quarto-table-cell-role="th">1965</th>
<th data-quarto-table-cell-role="th">1966</th>
<th data-quarto-table-cell-role="th">1967</th>
<th data-quarto-table-cell-role="th">1968</th>
<th data-quarto-table-cell-role="th">1969</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">1998</th>
<th data-quarto-table-cell-role="th">1999</th>
<th data-quarto-table-cell-role="th">2000</th>
<th data-quarto-table-cell-role="th">2001</th>
<th data-quarto-table-cell-role="th">2002</th>
<th data-quarto-table-cell-role="th">2003</th>
<th data-quarto-table-cell-role="th">2004</th>
<th data-quarto-table-cell-role="th">2005</th>
<th data-quarto-table-cell-role="th">2006</th>
<th data-quarto-table-cell-role="th">2007</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>China</td>
<td>58340740.0</td>
<td>60690860.0</td>
<td>63942700.0</td>
<td>68462610.0</td>
<td>74747900.0</td>
<td>80445930.0</td>
<td>81718660.0</td>
<td>81474800.0</td>
<td>82195340.0</td>
<td>...</td>
<td>295117400.0</td>
<td>304490200.0</td>
<td>315511100.0</td>
<td>322771800.0</td>
<td>336394800.0</td>
<td>340623800.0</td>
<td>360834700.0</td>
<td>371939300.0</td>
<td>380320200.0</td>
<td>386448200.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>United States of America</td>
<td>89816580.0</td>
<td>90275010.0</td>
<td>93700380.0</td>
<td>94323650.0</td>
<td>97704050.0</td>
<td>97277180.0</td>
<td>101177900.0</td>
<td>103420600.0</td>
<td>104285200.0</td>
<td>...</td>
<td>167311700.0</td>
<td>170083400.0</td>
<td>173640200.0</td>
<td>170755800.0</td>
<td>167494400.0</td>
<td>172458200.0</td>
<td>183519100.0</td>
<td>181432900.0</td>
<td>176803000.0</td>
<td>184698800.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>India</td>
<td>50142680.0</td>
<td>50015760.0</td>
<td>51367730.0</td>
<td>52267720.0</td>
<td>49498330.0</td>
<td>49309560.0</td>
<td>52731470.0</td>
<td>55208160.0</td>
<td>56970870.0</td>
<td>...</td>
<td>137406600.0</td>
<td>143567200.0</td>
<td>142989200.0</td>
<td>147351100.0</td>
<td>137112300.0</td>
<td>151552000.0</td>
<td>149552600.0</td>
<td>156869200.0</td>
<td>164974800.0</td>
<td>175747700.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>USSR</td>
<td>72768810.0</td>
<td>73961920.0</td>
<td>70531000.0</td>
<td>81216890.0</td>
<td>80941960.0</td>
<td>90781310.0</td>
<td>92659220.0</td>
<td>98507460.0</td>
<td>93745540.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Brazil</td>
<td>16564600.0</td>
<td>17344940.0</td>
<td>17443010.0</td>
<td>17658130.0</td>
<td>20367240.0</td>
<td>19238750.0</td>
<td>20650260.0</td>
<td>21256810.0</td>
<td>22008700.0</td>
<td>...</td>
<td>60706480.0</td>
<td>65353180.0</td>
<td>67416260.0</td>
<td>71250310.0</td>
<td>75603330.0</td>
<td>81198510.0</td>
<td>85626940.0</td>
<td>87363190.0</td>
<td>85319580.0</td>
<td>90075170.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">215</td>
<td>Tuvalu</td>
<td>473.0</td>
<td>474.0</td>
<td>476.0</td>
<td>513.0</td>
<td>514.0</td>
<td>515.0</td>
<td>467.0</td>
<td>438.0</td>
<td>400.0</td>
<td>...</td>
<td>466.0</td>
<td>480.0</td>
<td>482.0</td>
<td>500.0</td>
<td>511.0</td>
<td>528.0</td>
<td>541.0</td>
<td>541.0</td>
<td>541.0</td>
<td>558.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">216</td>
<td>Nauru</td>
<td>184.0</td>
<td>184.0</td>
<td>185.0</td>
<td>191.0</td>
<td>212.0</td>
<td>213.0</td>
<td>218.0</td>
<td>219.0</td>
<td>233.0</td>
<td>...</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>349.0</td>
<td>379.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">217</td>
<td>Tokelau</td>
<td>170.0</td>
<td>220.0</td>
<td>112.0</td>
<td>281.0</td>
<td>256.0</td>
<td>205.0</td>
<td>184.0</td>
<td>198.0</td>
<td>198.0</td>
<td>...</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
<td>346.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">218</td>
<td>Cayman Islands</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>200.0</td>
<td>202.0</td>
<td>202.0</td>
<td>206.0</td>
<td>...</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>125.0</td>
<td>127.0</td>
<td>129.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">219</td>
<td>Saint Pierre and Miquelon</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>21.0</td>
<td>21.0</td>
<td>25.0</td>
<td>26.0</td>
<td>28.0</td>
<td>25.0</td>
<td>26.0</td>
<td>24.0</td>
<td>26.0</td>
<td>23.0</td>
</tr>
</tbody>
</table>

<p>220 rows √ó 48 columns</p>
</div>
</div>
</div>
</section>
<section id="dataframe-demo-review-code" class="slide level2" style="font-size: 0.8em">
<h2>DataFrame demo review code</h2>
<ul>
<li>Choose inputs <code>countries = st.multiselect()</code></li>
<li>Print table using <code>st.write()</code></li>
<li><code>melt</code> for <code>chart</code></li>
</ul>
<div id="648abc45" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb6-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb6-3"><a href=""></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb6-4"><a href=""></a><span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb6-5"><a href=""></a></span>
<span id="cb6-6"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"DataFrame Demo"</span>, page_icon<span class="op">=</span><span class="st">"üìä"</span>)</span>
<span id="cb6-7"><a href=""></a></span>
<span id="cb6-8"><a href=""></a>st.markdown(<span class="st">"# DataFrame Demo"</span>)</span>
<span id="cb6-9"><a href=""></a>st.sidebar.header(<span class="st">"DataFrame Demo"</span>)</span>
<span id="cb6-10"><a href=""></a>st.write(</span>
<span id="cb6-11"><a href=""></a>    <span class="st">"""This demo shows how to use `st.write` to visualize Pandas DataFrames.</span></span>
<span id="cb6-12"><a href=""></a><span class="st">(Data courtesy of the [UN Data Explorer](http://data.un.org/Explorer.aspx).)"""</span></span>
<span id="cb6-13"><a href=""></a>)</span>
<span id="cb6-14"><a href=""></a></span>
<span id="cb6-15"><a href=""></a></span>
<span id="cb6-16"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb6-17"><a href=""></a><span class="kw">def</span> get_UN_data():</span>
<span id="cb6-18"><a href=""></a>    AWS_BUCKET_URL <span class="op">=</span> <span class="st">"http://streamlit-demo-data.s3-us-west-2.amazonaws.com"</span></span>
<span id="cb6-19"><a href=""></a>    df <span class="op">=</span> pd.read_csv(AWS_BUCKET_URL <span class="op">+</span> <span class="st">"/agri.csv.gz"</span>)</span>
<span id="cb6-20"><a href=""></a>    <span class="cf">return</span> df.set_index(<span class="st">"Region"</span>)</span>
<span id="cb6-21"><a href=""></a></span>
<span id="cb6-22"><a href=""></a></span>
<span id="cb6-23"><a href=""></a><span class="cf">try</span>:</span>
<span id="cb6-24"><a href=""></a>    df <span class="op">=</span> get_UN_data()</span>
<span id="cb6-25"><a href=""></a>    countries <span class="op">=</span> st.multiselect(</span>
<span id="cb6-26"><a href=""></a>        <span class="st">"Choose countries"</span>, <span class="bu">list</span>(df.index), [<span class="st">"China"</span>, <span class="st">"United States of America"</span>]</span>
<span id="cb6-27"><a href=""></a>    )</span>
<span id="cb6-28"><a href=""></a>    <span class="cf">if</span> <span class="kw">not</span> countries:</span>
<span id="cb6-29"><a href=""></a>        st.error(<span class="st">"Please select at least one country."</span>)</span>
<span id="cb6-30"><a href=""></a>    <span class="cf">else</span>:</span>
<span id="cb6-31"><a href=""></a>        data <span class="op">=</span> df.loc[countries]</span>
<span id="cb6-32"><a href=""></a>        data <span class="op">/=</span> <span class="fl">1000000.0</span></span>
<span id="cb6-33"><a href=""></a>        st.write(<span class="st">"### Gross Agricultural Production ($B)"</span>)</span>
<span id="cb6-34"><a href=""></a></span>
<span id="cb6-35"><a href=""></a>        <span class="co">#print pandas dataframe as a nicely formatted table (kable)</span></span>
<span id="cb6-36"><a href=""></a>        st.write(data.sort_index())</span>
<span id="cb6-37"><a href=""></a></span>
<span id="cb6-38"><a href=""></a>        data <span class="op">=</span> data.T.reset_index()</span>
<span id="cb6-39"><a href=""></a>        data <span class="op">=</span> pd.melt(data, id_vars<span class="op">=</span>[<span class="st">"index"</span>]).rename(</span>
<span id="cb6-40"><a href=""></a>            columns<span class="op">=</span>{<span class="st">"index"</span>: <span class="st">"year"</span>, <span class="st">"value"</span>: <span class="st">"Gross Agricultural Product ($B)"</span>}</span>
<span id="cb6-41"><a href=""></a>        )</span>
<span id="cb6-42"><a href=""></a>        chart <span class="op">=</span> (</span>
<span id="cb6-43"><a href=""></a>            alt.Chart(data)</span>
<span id="cb6-44"><a href=""></a>            .mark_area(opacity<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb6-45"><a href=""></a>            .encode(</span>
<span id="cb6-46"><a href=""></a>                x<span class="op">=</span><span class="st">"year:T"</span>,</span>
<span id="cb6-47"><a href=""></a>                y<span class="op">=</span>alt.Y(<span class="st">"Gross Agricultural Product ($B):Q"</span>, stack<span class="op">=</span><span class="va">None</span>),</span>
<span id="cb6-48"><a href=""></a>                color<span class="op">=</span><span class="st">"Region:N"</span>,</span>
<span id="cb6-49"><a href=""></a>            )</span>
<span id="cb6-50"><a href=""></a>        )</span>
<span id="cb6-51"><a href=""></a>        st.altair_chart(chart, use_container_width<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-52"><a href=""></a><span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb6-53"><a href=""></a>    st.error(</span>
<span id="cb6-54"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb6-55"><a href=""></a><span class="st">        **This demo requires internet access.**</span></span>
<span id="cb6-56"><a href=""></a><span class="st">        Connection error: </span><span class="sc">%s</span></span>
<span id="cb6-57"><a href=""></a><span class="st">    """</span></span>
<span id="cb6-58"><a href=""></a>        <span class="op">%</span> e.reason</span>
<span id="cb6-59"><a href=""></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-st.write" class="slide level2">
<h2>Feature: <code>st.write()</code></h2>
<ul>
<li>In this example, <code>st.write()</code> is used to make a table (analogous to <code>print()</code> or <code>head()</code>)</li>
<li>Useful tip: <code>st.write()</code> is Streamlit‚Äôs ‚ÄúSwiss Army knife‚Äù. Pass almost anything: latex, Matplotlib figures, Altair charts, multiple arguments, and more. Don‚Äôt worry, Streamlit will figure it out and render things the right way. Full list <a href="https://docs.streamlit.io/develop/api-reference/write-magic/st.write">here</a></li>
</ul>
</section>
<section id="mapping-demo-data-preview" class="slide level2" style="font-size: 0.8em">
<h2>Mapping demo data preview</h2>
<p>Runs on <a href="https://deckgl.readthedocs.io/en/latest/"><code>pydeck</code></a> (‚ÄúHigh-scale spatial rendering‚Äù). Makes gorgeous maps (will revisit). In Terminal/command line: <code>$ pip install pydeck</code></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>data preview</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bike_rental_stats.json">bike_rental_stats</a></td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
</tr>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_path_stats.json">bart_path_stats</a></td>
</tr>
</tbody>
</table>
</section>
<section id="mapping-demo-review-code" class="slide level2">
<h2>mapping demo review code</h2>
<p>Review <code>HexagonLayer</code>, <code>ScatterplotLayer</code>, <code>TextLayer</code>, <code>ArcLayer</code></p>
<div id="82f87ff6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb7-2"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb7-3"><a href=""></a><span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb7-4"><a href=""></a><span class="im">from</span> urllib.error <span class="im">import</span> URLError</span>
<span id="cb7-5"><a href=""></a></span>
<span id="cb7-6"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Mapping Demo"</span>, page_icon<span class="op">=</span><span class="st">"üåç"</span>)</span>
<span id="cb7-7"><a href=""></a></span>
<span id="cb7-8"><a href=""></a>st.markdown(<span class="st">"# Mapping Demo"</span>)</span>
<span id="cb7-9"><a href=""></a>st.sidebar.header(<span class="st">"Mapping Demo"</span>)</span>
<span id="cb7-10"><a href=""></a>st.write(</span>
<span id="cb7-11"><a href=""></a>    <span class="st">"""This demo shows how to use</span></span>
<span id="cb7-12"><a href=""></a><span class="st">[`st.pydeck_chart`](https://docs.streamlit.io/develop/api-reference/charts/st.pydeck_chart)</span></span>
<span id="cb7-13"><a href=""></a><span class="st">to display geospatial data."""</span></span>
<span id="cb7-14"><a href=""></a>)</span>
<span id="cb7-15"><a href=""></a></span>
<span id="cb7-16"><a href=""></a></span>
<span id="cb7-17"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb7-18"><a href=""></a><span class="kw">def</span> from_data_file(filename):</span>
<span id="cb7-19"><a href=""></a>    url <span class="op">=</span> (</span>
<span id="cb7-20"><a href=""></a>        <span class="st">"http://raw.githubusercontent.com/streamlit/"</span></span>
<span id="cb7-21"><a href=""></a>        <span class="st">"example-data/master/hello/v1/</span><span class="sc">%s</span><span class="st">"</span> <span class="op">%</span> filename</span>
<span id="cb7-22"><a href=""></a>    )</span>
<span id="cb7-23"><a href=""></a>    <span class="cf">return</span> pd.read_json(url)</span>
<span id="cb7-24"><a href=""></a></span>
<span id="cb7-25"><a href=""></a></span>
<span id="cb7-26"><a href=""></a><span class="cf">try</span>:</span>
<span id="cb7-27"><a href=""></a>    ALL_LAYERS <span class="op">=</span> {</span>
<span id="cb7-28"><a href=""></a>        <span class="st">"Bike Rentals"</span>: pdk.Layer(</span>
<span id="cb7-29"><a href=""></a>            <span class="st">"HexagonLayer"</span>,</span>
<span id="cb7-30"><a href=""></a>            data<span class="op">=</span>from_data_file(<span class="st">"bike_rental_stats.json"</span>),</span>
<span id="cb7-31"><a href=""></a>            get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb7-32"><a href=""></a>            radius<span class="op">=</span><span class="dv">200</span>,</span>
<span id="cb7-33"><a href=""></a>            elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb7-34"><a href=""></a>            elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb7-35"><a href=""></a>            extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-36"><a href=""></a>        ),</span>
<span id="cb7-37"><a href=""></a>        <span class="st">"Bart Stop Exits"</span>: pdk.Layer(</span>
<span id="cb7-38"><a href=""></a>            <span class="st">"ScatterplotLayer"</span>,</span>
<span id="cb7-39"><a href=""></a>            data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb7-40"><a href=""></a>            get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb7-41"><a href=""></a>            get_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb7-42"><a href=""></a>            get_radius<span class="op">=</span><span class="st">"[exits]"</span>,</span>
<span id="cb7-43"><a href=""></a>            radius_scale<span class="op">=</span><span class="fl">0.05</span>,</span>
<span id="cb7-44"><a href=""></a>        ),</span>
<span id="cb7-45"><a href=""></a>        <span class="st">"Bart Stop Names"</span>: pdk.Layer(</span>
<span id="cb7-46"><a href=""></a>            <span class="st">"TextLayer"</span>,</span>
<span id="cb7-47"><a href=""></a>            data<span class="op">=</span>from_data_file(<span class="st">"bart_stop_stats.json"</span>),</span>
<span id="cb7-48"><a href=""></a>            get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb7-49"><a href=""></a>            get_text<span class="op">=</span><span class="st">"name"</span>,</span>
<span id="cb7-50"><a href=""></a>            get_color<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">200</span>],</span>
<span id="cb7-51"><a href=""></a>            get_size<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb7-52"><a href=""></a>            get_alignment_baseline<span class="op">=</span><span class="st">"'bottom'"</span>,</span>
<span id="cb7-53"><a href=""></a>        ),</span>
<span id="cb7-54"><a href=""></a>        <span class="st">"Outbound Flow"</span>: pdk.Layer(</span>
<span id="cb7-55"><a href=""></a>            <span class="st">"ArcLayer"</span>,</span>
<span id="cb7-56"><a href=""></a>            data<span class="op">=</span>from_data_file(<span class="st">"bart_path_stats.json"</span>),</span>
<span id="cb7-57"><a href=""></a>            get_source_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb7-58"><a href=""></a>            get_target_position<span class="op">=</span>[<span class="st">"lon2"</span>, <span class="st">"lat2"</span>],</span>
<span id="cb7-59"><a href=""></a>            get_source_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb7-60"><a href=""></a>            get_target_color<span class="op">=</span>[<span class="dv">200</span>, <span class="dv">30</span>, <span class="dv">0</span>, <span class="dv">160</span>],</span>
<span id="cb7-61"><a href=""></a>            auto_highlight<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb7-62"><a href=""></a>            width_scale<span class="op">=</span><span class="fl">0.0001</span>,</span>
<span id="cb7-63"><a href=""></a>            get_width<span class="op">=</span><span class="st">"outbound"</span>,</span>
<span id="cb7-64"><a href=""></a>            width_min_pixels<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb7-65"><a href=""></a>            width_max_pixels<span class="op">=</span><span class="dv">30</span>,</span>
<span id="cb7-66"><a href=""></a>        ),</span>
<span id="cb7-67"><a href=""></a>    }</span>
<span id="cb7-68"><a href=""></a>    st.sidebar.markdown(<span class="st">"### Map Layers"</span>)</span>
<span id="cb7-69"><a href=""></a>    selected_layers <span class="op">=</span> [</span>
<span id="cb7-70"><a href=""></a>        layer</span>
<span id="cb7-71"><a href=""></a>        <span class="cf">for</span> layer_name, layer <span class="kw">in</span> ALL_LAYERS.items()</span>
<span id="cb7-72"><a href=""></a>        <span class="cf">if</span> st.sidebar.checkbox(layer_name, <span class="va">True</span>)</span>
<span id="cb7-73"><a href=""></a>    ]</span>
<span id="cb7-74"><a href=""></a>    <span class="cf">if</span> selected_layers:</span>
<span id="cb7-75"><a href=""></a>        st.pydeck_chart(</span>
<span id="cb7-76"><a href=""></a>            pdk.Deck(</span>
<span id="cb7-77"><a href=""></a>                map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb7-78"><a href=""></a>                initial_view_state<span class="op">=</span>{</span>
<span id="cb7-79"><a href=""></a>                    <span class="st">"latitude"</span>: <span class="fl">37.76</span>,</span>
<span id="cb7-80"><a href=""></a>                    <span class="st">"longitude"</span>: <span class="op">-</span><span class="fl">122.4</span>,</span>
<span id="cb7-81"><a href=""></a>                    <span class="st">"zoom"</span>: <span class="dv">11</span>,</span>
<span id="cb7-82"><a href=""></a>                    <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb7-83"><a href=""></a>                },</span>
<span id="cb7-84"><a href=""></a>                layers<span class="op">=</span>selected_layers,</span>
<span id="cb7-85"><a href=""></a>            )</span>
<span id="cb7-86"><a href=""></a>        )</span>
<span id="cb7-87"><a href=""></a>    <span class="cf">else</span>:</span>
<span id="cb7-88"><a href=""></a>        st.error(<span class="st">"Please choose at least one layer above."</span>)</span>
<span id="cb7-89"><a href=""></a><span class="cf">except</span> URLError <span class="im">as</span> e:</span>
<span id="cb7-90"><a href=""></a>    st.error(</span>
<span id="cb7-91"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb7-92"><a href=""></a><span class="st">        **This demo requires internet access.**</span></span>
<span id="cb7-93"><a href=""></a><span class="st">        Connection error: </span><span class="sc">%s</span></span>
<span id="cb7-94"><a href=""></a><span class="st">    """</span></span>
<span id="cb7-95"><a href=""></a>        <span class="op">%</span> e.reason</span>
<span id="cb7-96"><a href=""></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="optional-summarize-how-each-dataset-is-used" class="slide level2" style="font-size: 0.8em">
<h2>(Optional) Summarize how each dataset is used</h2>
<table class="caption-top">
<thead>
<tr class="header">
<th>Data preview</th>
<th>Layer name</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bike_rental_stats.json">bike_rental_stats</a></td>
<td><code>HexagonLayer</code></td>
<td>bar height set by number of rental at each lat lon</td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
<td><code>ScatterplotLayer</code></td>
<td>radius = <code>exits</code></td>
</tr>
<tr class="odd">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_stop_stats.json">bart_stop_stats</a></td>
<td><code>TextLayer</code></td>
<td><code>get_text="name"</code></td>
</tr>
<tr class="even">
<td><a href="http://raw.githubusercontent.com/streamlit/example-data/master/hello/v1/bart_path_stats.json">bart_path_stats</a></td>
<td><code>ArcLayer</code></td>
<td>arcs via <code>get_source_position = ["lon", "lat"], get_target_position = ["lon2", "lat2"]</code></td>
</tr>
</tbody>
</table>
<aside class="notes">
<p>Not sure we will need to talk about this. only cover it if people are confused from looking at the code itself.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="uber-pickups-a-full-fledged-dashboard" class="slide level2">
<h2>Uber pickups: a full-fledged dashboard</h2>
<p><a href="http://uchicago-harris-dap-dashboards-4.streamlit.app/">http://uchicago-harris-dap-dashboards-4.streamlit.app/</a></p>
<ul>
<li>This is the ‚Äúclassic‚Äù Streamlit dashboard (the one they use in all the demos)</li>
<li>Why? Pretty, adapts nicely to user input, and it showcases integration with <code>pydeck</code> and <code>altair</code>.</li>
</ul>
</section>
<section id="uber-pickups-preview-data" class="slide level2">
<h2>Uber pickups: preview data</h2>
<div id="9285630a" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href=""></a><span class="im">import</span> os</span>
<span id="cb8-2"><a href=""></a><span class="kw">def</span> load_data():</span>
<span id="cb8-3"><a href=""></a>    path <span class="op">=</span> <span class="st">"uber-raw-data-sep14.csv.gz"</span></span>
<span id="cb8-4"><a href=""></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(path):</span>
<span id="cb8-5"><a href=""></a>        path <span class="op">=</span> <span class="ss">f"https://github.com/streamlit/demo-uber-nyc-pickups/raw/main/</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb8-6"><a href=""></a></span>
<span id="cb8-7"><a href=""></a>    data <span class="op">=</span> pd.read_csv(</span>
<span id="cb8-8"><a href=""></a>        path,</span>
<span id="cb8-9"><a href=""></a>        nrows<span class="op">=</span><span class="dv">6</span>,  </span>
<span id="cb8-10"><a href=""></a>        names<span class="op">=</span>[</span>
<span id="cb8-11"><a href=""></a>            <span class="st">"date/time"</span>,</span>
<span id="cb8-12"><a href=""></a>            <span class="st">"lat"</span>,</span>
<span id="cb8-13"><a href=""></a>            <span class="st">"lon"</span>,</span>
<span id="cb8-14"><a href=""></a>        ],  <span class="co"># specify names directly since they don't change</span></span>
<span id="cb8-15"><a href=""></a>        skiprows<span class="op">=</span><span class="dv">1</span>,  <span class="co"># don't read header since names specified directly</span></span>
<span id="cb8-16"><a href=""></a>        usecols<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],  <span class="co"># doesn't load last column, constant value "B02512"</span></span>
<span id="cb8-17"><a href=""></a>        parse_dates<span class="op">=</span>[</span>
<span id="cb8-18"><a href=""></a>            <span class="st">"date/time"</span></span>
<span id="cb8-19"><a href=""></a>        ],  <span class="co"># set as datetime instead of converting after the fact</span></span>
<span id="cb8-20"><a href=""></a>    )</span>
<span id="cb8-21"><a href=""></a></span>
<span id="cb8-22"><a href=""></a>    <span class="cf">return</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="0734c34f" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href=""></a>load_data()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date/time</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2014-09-01 00:01:00</td>
<td>40.2201</td>
<td>-74.0021</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2014-09-01 00:01:00</td>
<td>40.7500</td>
<td>-74.0027</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2014-09-01 00:03:00</td>
<td>40.7559</td>
<td>-73.9864</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2014-09-01 00:06:00</td>
<td>40.7450</td>
<td>-73.9889</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2014-09-01 00:11:00</td>
<td>40.8145</td>
<td>-73.9444</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>2014-09-01 00:12:00</td>
<td>40.6735</td>
<td>-73.9918</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="uber-pickups-review-code" class="slide level2" style="font-size: 0.7em">
<h2>Uber pickups review code</h2>
<ul>
<li>User chooses time of day (<code>pickup_hour</code>) ‚Äì line 115</li>
<li>Helper function <code>filterdata(data, hour_selected)</code> ‚Äì line 69</li>
<li><code>map(data, lat, lon, zoom)</code> makes a PyDeck <code>HexagonLayer</code> (line 41). Repeat 4x (lines 140-157).</li>
<li><code>histdata(df, hr)</code> makes an altair histogram with n rides ‚Äì lines 170-182</li>
</ul>
<div id="26e2bf7f" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href=""></a><span class="co">"""An example of showing geographic data."""</span></span>
<span id="cb10-2"><a href=""></a></span>
<span id="cb10-3"><a href=""></a><span class="im">import</span> os</span>
<span id="cb10-4"><a href=""></a></span>
<span id="cb10-5"><a href=""></a><span class="im">import</span> altair <span class="im">as</span> alt</span>
<span id="cb10-6"><a href=""></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-7"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-8"><a href=""></a><span class="im">import</span> pydeck <span class="im">as</span> pdk</span>
<span id="cb10-9"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb10-10"><a href=""></a></span>
<span id="cb10-11"><a href=""></a><span class="co"># SETTING PAGE CONFIG TO WIDE MODE AND ADDING A TITLE AND FAVICON</span></span>
<span id="cb10-12"><a href=""></a>st.set_page_config(layout<span class="op">=</span><span class="st">"wide"</span>, page_title<span class="op">=</span><span class="st">"NYC Ridesharing Demo"</span>, page_icon<span class="op">=</span><span class="st">":taxi:"</span>)</span>
<span id="cb10-13"><a href=""></a></span>
<span id="cb10-14"><a href=""></a></span>
<span id="cb10-15"><a href=""></a><span class="co"># LOAD DATA ONCE</span></span>
<span id="cb10-16"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb10-17"><a href=""></a><span class="kw">def</span> load_data():</span>
<span id="cb10-18"><a href=""></a>    path <span class="op">=</span> <span class="st">"uber-raw-data-sep14.csv.gz"</span></span>
<span id="cb10-19"><a href=""></a>    <span class="cf">if</span> <span class="kw">not</span> os.path.isfile(path):</span>
<span id="cb10-20"><a href=""></a>        path <span class="op">=</span> <span class="ss">f"https://github.com/streamlit/demo-uber-nyc-pickups/raw/main/</span><span class="sc">{</span>path<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb10-21"><a href=""></a></span>
<span id="cb10-22"><a href=""></a>    data <span class="op">=</span> pd.read_csv(</span>
<span id="cb10-23"><a href=""></a>        path,</span>
<span id="cb10-24"><a href=""></a>        nrows<span class="op">=</span><span class="dv">100000</span>,  <span class="co"># approx. 10% of data</span></span>
<span id="cb10-25"><a href=""></a>        names<span class="op">=</span>[</span>
<span id="cb10-26"><a href=""></a>            <span class="st">"date/time"</span>,</span>
<span id="cb10-27"><a href=""></a>            <span class="st">"lat"</span>,</span>
<span id="cb10-28"><a href=""></a>            <span class="st">"lon"</span>,</span>
<span id="cb10-29"><a href=""></a>        ],  <span class="co"># specify names directly since they don't change</span></span>
<span id="cb10-30"><a href=""></a>        skiprows<span class="op">=</span><span class="dv">1</span>,  <span class="co"># don't read header since names specified directly</span></span>
<span id="cb10-31"><a href=""></a>        usecols<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],  <span class="co"># doesn't load last column, constant value "B02512"</span></span>
<span id="cb10-32"><a href=""></a>        parse_dates<span class="op">=</span>[</span>
<span id="cb10-33"><a href=""></a>            <span class="st">"date/time"</span></span>
<span id="cb10-34"><a href=""></a>        ],  <span class="co"># set as datetime instead of converting after the fact</span></span>
<span id="cb10-35"><a href=""></a>    )</span>
<span id="cb10-36"><a href=""></a></span>
<span id="cb10-37"><a href=""></a>    <span class="cf">return</span> data</span>
<span id="cb10-38"><a href=""></a></span>
<span id="cb10-39"><a href=""></a></span>
<span id="cb10-40"><a href=""></a><span class="co"># FUNCTION FOR AIRPORT MAPS</span></span>
<span id="cb10-41"><a href=""></a><span class="kw">def</span> <span class="bu">map</span>(data, lat, lon, zoom):</span>
<span id="cb10-42"><a href=""></a>    st.write(</span>
<span id="cb10-43"><a href=""></a>        pdk.Deck(</span>
<span id="cb10-44"><a href=""></a>            map_style<span class="op">=</span><span class="st">"mapbox://styles/mapbox/light-v9"</span>,</span>
<span id="cb10-45"><a href=""></a>            initial_view_state<span class="op">=</span>{</span>
<span id="cb10-46"><a href=""></a>                <span class="st">"latitude"</span>: lat,</span>
<span id="cb10-47"><a href=""></a>                <span class="st">"longitude"</span>: lon,</span>
<span id="cb10-48"><a href=""></a>                <span class="st">"zoom"</span>: zoom,</span>
<span id="cb10-49"><a href=""></a>                <span class="st">"pitch"</span>: <span class="dv">50</span>,</span>
<span id="cb10-50"><a href=""></a>            },</span>
<span id="cb10-51"><a href=""></a>            layers<span class="op">=</span>[</span>
<span id="cb10-52"><a href=""></a>                pdk.Layer(</span>
<span id="cb10-53"><a href=""></a>                    <span class="st">"HexagonLayer"</span>,</span>
<span id="cb10-54"><a href=""></a>                    data<span class="op">=</span>data,</span>
<span id="cb10-55"><a href=""></a>                    get_position<span class="op">=</span>[<span class="st">"lon"</span>, <span class="st">"lat"</span>],</span>
<span id="cb10-56"><a href=""></a>                    radius<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb10-57"><a href=""></a>                    elevation_scale<span class="op">=</span><span class="dv">4</span>,</span>
<span id="cb10-58"><a href=""></a>                    elevation_range<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1000</span>],</span>
<span id="cb10-59"><a href=""></a>                    pickable<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-60"><a href=""></a>                    extruded<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-61"><a href=""></a>                ),</span>
<span id="cb10-62"><a href=""></a>            ],</span>
<span id="cb10-63"><a href=""></a>        )</span>
<span id="cb10-64"><a href=""></a>    )</span>
<span id="cb10-65"><a href=""></a></span>
<span id="cb10-66"><a href=""></a></span>
<span id="cb10-67"><a href=""></a><span class="co"># FILTER DATA FOR A SPECIFIC HOUR, CACHE</span></span>
<span id="cb10-68"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb10-69"><a href=""></a><span class="kw">def</span> filterdata(df, hour_selected):</span>
<span id="cb10-70"><a href=""></a>    <span class="cf">return</span> df[df[<span class="st">"date/time"</span>].dt.hour <span class="op">==</span> hour_selected]</span>
<span id="cb10-71"><a href=""></a></span>
<span id="cb10-72"><a href=""></a></span>
<span id="cb10-73"><a href=""></a><span class="co"># CALCULATE MIDPOINT FOR GIVEN SET OF DATA</span></span>
<span id="cb10-74"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb10-75"><a href=""></a><span class="kw">def</span> mpoint(lat, lon):</span>
<span id="cb10-76"><a href=""></a>    <span class="cf">return</span> (np.average(lat), np.average(lon))</span>
<span id="cb10-77"><a href=""></a></span>
<span id="cb10-78"><a href=""></a></span>
<span id="cb10-79"><a href=""></a><span class="co"># FILTER DATA BY HOUR</span></span>
<span id="cb10-80"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb10-81"><a href=""></a><span class="kw">def</span> histdata(df, hr):</span>
<span id="cb10-82"><a href=""></a>    filtered <span class="op">=</span> data[</span>
<span id="cb10-83"><a href=""></a>        (df[<span class="st">"date/time"</span>].dt.hour <span class="op">&gt;=</span> hr) <span class="op">&amp;</span> (df[<span class="st">"date/time"</span>].dt.hour <span class="op">&lt;</span> (hr <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb10-84"><a href=""></a>    ]</span>
<span id="cb10-85"><a href=""></a></span>
<span id="cb10-86"><a href=""></a>    hist <span class="op">=</span> np.histogram(filtered[<span class="st">"date/time"</span>].dt.minute, bins<span class="op">=</span><span class="dv">60</span>, <span class="bu">range</span><span class="op">=</span>(<span class="dv">0</span>, <span class="dv">60</span>))[<span class="dv">0</span>]</span>
<span id="cb10-87"><a href=""></a></span>
<span id="cb10-88"><a href=""></a>    <span class="cf">return</span> pd.DataFrame({<span class="st">"minute"</span>: <span class="bu">range</span>(<span class="dv">60</span>), <span class="st">"pickups"</span>: hist})</span>
<span id="cb10-89"><a href=""></a></span>
<span id="cb10-90"><a href=""></a></span>
<span id="cb10-91"><a href=""></a><span class="co"># STREAMLIT APP LAYOUT</span></span>
<span id="cb10-92"><a href=""></a>data <span class="op">=</span> load_data()</span>
<span id="cb10-93"><a href=""></a></span>
<span id="cb10-94"><a href=""></a><span class="co"># LAYING OUT THE TOP SECTION OF THE APP</span></span>
<span id="cb10-95"><a href=""></a>row1_1, row1_2 <span class="op">=</span> st.columns((<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb10-96"><a href=""></a></span>
<span id="cb10-97"><a href=""></a><span class="co"># SEE IF THERE'S A QUERY PARAM IN THE URL (e.g. ?pickup_hour=2)</span></span>
<span id="cb10-98"><a href=""></a><span class="co"># THIS ALLOWS YOU TO PASS A STATEFUL URL TO SOMEONE WITH A SPECIFIC HOUR SELECTED,</span></span>
<span id="cb10-99"><a href=""></a><span class="co"># E.G. https://share.streamlit.io/streamlit/demo-uber-nyc-pickups/main?pickup_hour=2</span></span>
<span id="cb10-100"><a href=""></a><span class="cf">if</span> <span class="kw">not</span> st.session_state.get(<span class="st">"url_synced"</span>, <span class="va">False</span>):</span>
<span id="cb10-101"><a href=""></a>    <span class="cf">try</span>:</span>
<span id="cb10-102"><a href=""></a>        pickup_hour <span class="op">=</span> <span class="bu">int</span>(st.query_params[<span class="st">"pickup_hour"</span>])</span>
<span id="cb10-103"><a href=""></a>        st.session_state[<span class="st">"pickup_hour"</span>] <span class="op">=</span> pickup_hour</span>
<span id="cb10-104"><a href=""></a>        st.session_state[<span class="st">"url_synced"</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb10-105"><a href=""></a>    <span class="cf">except</span> <span class="pp">KeyError</span>:</span>
<span id="cb10-106"><a href=""></a>        <span class="cf">pass</span></span>
<span id="cb10-107"><a href=""></a></span>
<span id="cb10-108"><a href=""></a></span>
<span id="cb10-109"><a href=""></a><span class="co"># IF THE SLIDER CHANGES, UPDATE THE QUERY PARAM</span></span>
<span id="cb10-110"><a href=""></a><span class="kw">def</span> update_query_params():</span>
<span id="cb10-111"><a href=""></a>    hour_selected <span class="op">=</span> st.session_state[<span class="st">"pickup_hour"</span>]</span>
<span id="cb10-112"><a href=""></a>    st.query_params[<span class="st">"pickup_hour"</span>] <span class="op">=</span> hour_selected</span>
<span id="cb10-113"><a href=""></a></span>
<span id="cb10-114"><a href=""></a></span>
<span id="cb10-115"><a href=""></a><span class="cf">with</span> row1_1:</span>
<span id="cb10-116"><a href=""></a>    st.title(<span class="st">"NYC Uber Ridesharing Data"</span>)</span>
<span id="cb10-117"><a href=""></a>    hour_selected <span class="op">=</span> st.slider(</span>
<span id="cb10-118"><a href=""></a>        <span class="st">"Select hour of pickup"</span>, <span class="dv">0</span>, <span class="dv">23</span>, key<span class="op">=</span><span class="st">"pickup_hour"</span>, on_change<span class="op">=</span>update_query_params</span>
<span id="cb10-119"><a href=""></a>    )</span>
<span id="cb10-120"><a href=""></a></span>
<span id="cb10-121"><a href=""></a></span>
<span id="cb10-122"><a href=""></a><span class="cf">with</span> row1_2:</span>
<span id="cb10-123"><a href=""></a>    st.write(</span>
<span id="cb10-124"><a href=""></a>        <span class="st">"""</span></span>
<span id="cb10-125"><a href=""></a><span class="st">    ##</span></span>
<span id="cb10-126"><a href=""></a><span class="st">    Examining how Uber pickups vary over time in New York City's and at its major regional airports.</span></span>
<span id="cb10-127"><a href=""></a><span class="st">    By sliding the slider on the left you can view different slices of time and explore different transportation trends.</span></span>
<span id="cb10-128"><a href=""></a><span class="st">    """</span></span>
<span id="cb10-129"><a href=""></a>    )</span>
<span id="cb10-130"><a href=""></a></span>
<span id="cb10-131"><a href=""></a><span class="co"># LAYING OUT THE MIDDLE SECTION OF THE APP WITH THE MAPS</span></span>
<span id="cb10-132"><a href=""></a>row2_1, row2_2, row2_3, row2_4 <span class="op">=</span> st.columns((<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb10-133"><a href=""></a></span>
<span id="cb10-134"><a href=""></a><span class="co"># SETTING THE ZOOM LOCATIONS FOR THE AIRPORTS</span></span>
<span id="cb10-135"><a href=""></a>la_guardia <span class="op">=</span> [<span class="fl">40.7900</span>, <span class="op">-</span><span class="fl">73.8700</span>]</span>
<span id="cb10-136"><a href=""></a>jfk <span class="op">=</span> [<span class="fl">40.6650</span>, <span class="op">-</span><span class="fl">73.7821</span>]</span>
<span id="cb10-137"><a href=""></a>newark <span class="op">=</span> [<span class="fl">40.7090</span>, <span class="op">-</span><span class="fl">74.1805</span>]</span>
<span id="cb10-138"><a href=""></a>zoom_level <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb10-139"><a href=""></a>midpoint <span class="op">=</span> mpoint(data[<span class="st">"lat"</span>], data[<span class="st">"lon"</span>])</span>
<span id="cb10-140"><a href=""></a></span>
<span id="cb10-141"><a href=""></a><span class="cf">with</span> row2_1:</span>
<span id="cb10-142"><a href=""></a>    st.write(</span>
<span id="cb10-143"><a href=""></a>        <span class="ss">f"""**All New York City from </span><span class="sc">{</span>hour_selected<span class="sc">}</span><span class="ss">:00 and </span><span class="sc">{</span>(hour_selected <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">24</span><span class="sc">}</span><span class="ss">:00**"""</span></span>
<span id="cb10-144"><a href=""></a>    )</span>
<span id="cb10-145"><a href=""></a>    <span class="bu">map</span>(filterdata(data, hour_selected), midpoint[<span class="dv">0</span>], midpoint[<span class="dv">1</span>], <span class="dv">11</span>)</span>
<span id="cb10-146"><a href=""></a></span>
<span id="cb10-147"><a href=""></a><span class="cf">with</span> row2_2:</span>
<span id="cb10-148"><a href=""></a>    st.write(<span class="st">"**La Guardia Airport**"</span>)</span>
<span id="cb10-149"><a href=""></a>    <span class="bu">map</span>(filterdata(data, hour_selected), la_guardia[<span class="dv">0</span>], la_guardia[<span class="dv">1</span>], zoom_level)</span>
<span id="cb10-150"><a href=""></a></span>
<span id="cb10-151"><a href=""></a><span class="cf">with</span> row2_3:</span>
<span id="cb10-152"><a href=""></a>    st.write(<span class="st">"**JFK Airport**"</span>)</span>
<span id="cb10-153"><a href=""></a>    <span class="bu">map</span>(filterdata(data, hour_selected), jfk[<span class="dv">0</span>], jfk[<span class="dv">1</span>], zoom_level)</span>
<span id="cb10-154"><a href=""></a></span>
<span id="cb10-155"><a href=""></a><span class="cf">with</span> row2_4:</span>
<span id="cb10-156"><a href=""></a>    st.write(<span class="st">"**Newark Airport**"</span>)</span>
<span id="cb10-157"><a href=""></a>    <span class="bu">map</span>(filterdata(data, hour_selected), newark[<span class="dv">0</span>], newark[<span class="dv">1</span>], zoom_level)</span>
<span id="cb10-158"><a href=""></a></span>
<span id="cb10-159"><a href=""></a><span class="co"># CALCULATING DATA FOR THE HISTOGRAM</span></span>
<span id="cb10-160"><a href=""></a>chart_data <span class="op">=</span> histdata(data, hour_selected)</span>
<span id="cb10-161"><a href=""></a></span>
<span id="cb10-162"><a href=""></a><span class="co"># LAYING OUT THE HISTOGRAM SECTION</span></span>
<span id="cb10-163"><a href=""></a>st.write(</span>
<span id="cb10-164"><a href=""></a>    <span class="ss">f"""**Breakdown of rides per minute between </span><span class="sc">{</span>hour_selected<span class="sc">}</span><span class="ss">:00 and </span><span class="sc">{</span>(hour_selected <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">24</span><span class="sc">}</span><span class="ss">:00**"""</span></span>
<span id="cb10-165"><a href=""></a>)</span>
<span id="cb10-166"><a href=""></a></span>
<span id="cb10-167"><a href=""></a>st.altair_chart(</span>
<span id="cb10-168"><a href=""></a>    alt.Chart(chart_data)</span>
<span id="cb10-169"><a href=""></a>    .mark_area(</span>
<span id="cb10-170"><a href=""></a>        interpolate<span class="op">=</span><span class="st">"step-after"</span>,</span>
<span id="cb10-171"><a href=""></a>    )</span>
<span id="cb10-172"><a href=""></a>    .encode(</span>
<span id="cb10-173"><a href=""></a>        x<span class="op">=</span>alt.X(<span class="st">"minute:Q"</span>, scale<span class="op">=</span>alt.Scale(nice<span class="op">=</span><span class="va">False</span>)),</span>
<span id="cb10-174"><a href=""></a>        y<span class="op">=</span>alt.Y(<span class="st">"pickups:Q"</span>),</span>
<span id="cb10-175"><a href=""></a>        tooltip<span class="op">=</span>[<span class="st">"minute"</span>, <span class="st">"pickups"</span>],</span>
<span id="cb10-176"><a href=""></a>    )</span>
<span id="cb10-177"><a href=""></a>    .configure_mark(opacity<span class="op">=</span><span class="fl">0.2</span>, color<span class="op">=</span><span class="st">"red"</span>),</span>
<span id="cb10-178"><a href=""></a>    use_container_width<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb10-179"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<aside class="notes">
<p>Discussion question ‚Äì Why does <code>map</code> need to take lat and lon as an argument? Answer: this is saying where we should be looking when the map is first created</p>
<p>Show that if you zoom out on the three airports you get back to the exact same underlying dataset, it‚Äôs just starting in a different place.</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
<!-- MS to PG: at this point I started to get pretty confused :( I don't understand what st.session_state means. 

I see you define it later under "What is a session"

PG to MS reformatted it to just say pickup hour without mentioning session state -->
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p>Saw four dashboards</p>
<ul>
<li>Multipage
<ul>
<li>plot</li>
<li>data frame</li>
<li>map</li>
</ul></li>
<li>Uber pickups ‚Äì map + plot</li>
</ul>
</section></section>
<section>
<section id="demystifying-dashboards" class="title-slide slide level1 center">
<h1>Demystifying dashboards</h1>

</section>
<section id="roadmap-1" class="slide level2">
<h2>Roadmap</h2>
<ul>
<li>Why dashboards are different than <code>.py</code> (or notebooks or <code>qmd</code>)</li>
<li>Bare vs streamlit mode</li>
<li>toy example of what streamlit mode can do</li>
<li>What is a session?</li>
</ul>
</section>
<section id="why-dashboards-are-different-than-.py" class="slide level2" style="font-size: 0.8em">
<h2>Why dashboards are different than <code>.py</code></h2>
<p>The first section of this lecture treated dashboards as websites without user input. This is like a normal Python script. Run once and gives you output.</p>
<p>The second section made dashboards interactive. To do this, it must be the case that the entire dashboard, or some part of it, may be run more than once.</p>
<ul>
<li>In Terminal/command line: <code>$ pip install watchdog</code></li>
</ul>
<p><code>watchdog</code> is the file-watching library Streamlit leans on to detect code/data changes (like when we got the option to ‚Äúre-run‚Äù with dashboard 2)</p>
</section>
<section id="bare-mode-vs-streamlit-mode" class="slide level2" style="font-size: 0.8em">
<h2>Bare mode vs streamlit mode</h2>
<ul>
<li>‚ÄúBare mode‚Äù (<code>$ python app.py</code>) runs your script like standard Python; output is just whatever the script prints.</li>
<li>‚ÄúStreamlit mode‚Äù (<code>$ python -m streamlit run app.py</code> or for short <code>$ streamlit run app.py</code>) does four things:
<ul>
<li>sets up a server to run your script</li>
<li>records the state (e.g.&nbsp;the choice in <code>st.selectbox</code>)</li>
<li>reruns code on state changes (e.g.&nbsp;new choice in in <code>st.selectbox</code>)</li>
<li>serves the interactive user interface (UI) found in the browser</li>
</ul></li>
<li>There‚Äôs a lot of extra code under the hood, streamlit‚Äôs goal is for you to focus on the Python code (and ignore all the running a server, taking user input, designing a nice webpage)</li>
</ul>
</section>
<section id="simple-re-run-demo-overview" class="slide level2" style="font-size: 0.8em">
<h2>Simple re-run demo overview</h2>
<p><a href="http://uchicago-harris-dap-dashboards-5.streamlit.app/">http://uchicago-harris-dap-dashboards-5.streamlit.app/</a></p>
<ul>
<li><code>$ streamlit run 5/session_state_example.py</code></li>
<li>User chooses <code>route = st.selectbox("CTA Route", ...)</code> and <code>cut_pct = st.slider("What fraction of service to cut?", ...)</code></li>
<li>Computer then runs a computation which takes 3 seconds (on the pset, you will see an example where it takes much longer than 3 seconds)</li>
<li>Returns a result</li>
<li>What if we want to run the exact same computation twice? Better to use the saved result!</li>
</ul>
<!-- MS to GGG: in the session_state_example.py code, I would add "min_value=  0.0, max_value = 50.0, value= 10.0 to line 10 so that students can reference it as an example to work off of for the do-pair-share -->
</section>
<section id="simple-re-run-demo-review-code" class="slide level2">
<h2>Simple re-run demo review code</h2>
<div id="2be5356e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb11-2"><a href=""></a><span class="im">import</span> time</span>
<span id="cb11-3"><a href=""></a></span>
<span id="cb11-4"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"Expensive Calculation"</span>)</span>
<span id="cb11-5"><a href=""></a></span>
<span id="cb11-6"><a href=""></a>st.title(<span class="st">"Expensive Calculation Demo"</span>)</span>
<span id="cb11-7"><a href=""></a></span>
<span id="cb11-8"><a href=""></a><span class="co"># user inputs</span></span>
<span id="cb11-9"><a href=""></a>route <span class="op">=</span> st.selectbox(<span class="st">"CTA route to cut"</span>, [<span class="st">"Red Line"</span>, <span class="st">"Blue Line"</span>, <span class="st">"Green Line"</span>])</span>
<span id="cb11-10"><a href=""></a>cut_pct <span class="op">=</span> st.slider(<span class="st">"What fraction of service to cut?"</span>, <span class="fl">0.0</span>, <span class="fl">50.0</span>, <span class="fl">10.0</span>, step<span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb11-11"><a href=""></a></span>
<span id="cb11-12"><a href=""></a><span class="cf">if</span> <span class="st">"counter"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb11-13"><a href=""></a>    st.session_state.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-14"><a href=""></a></span>
<span id="cb11-15"><a href=""></a><span class="co"># session_state key</span></span>
<span id="cb11-16"><a href=""></a>key <span class="op">=</span> <span class="ss">f"n_pass_</span><span class="sc">{</span>route<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>cut_pct<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb11-17"><a href=""></a></span>
<span id="cb11-18"><a href=""></a><span class="co"># run the heavy job only if we haven't already stored it</span></span>
<span id="cb11-19"><a href=""></a><span class="cf">if</span> key <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb11-20"><a href=""></a>    <span class="cf">with</span> st.spinner(<span class="st">"Crunching numbers..."</span>):</span>
<span id="cb11-21"><a href=""></a>        time.sleep(<span class="dv">3</span>)  <span class="co"># stand‚Äëin for a slow computation</span></span>
<span id="cb11-22"><a href=""></a>        st.session_state[key] <span class="op">=</span> (<span class="dv">100</span> <span class="op">-</span> cut_pct) <span class="op">*</span> <span class="fl">1.2345</span>  <span class="co"># fake result</span></span>
<span id="cb11-23"><a href=""></a>    st.session_state.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb11-24"><a href=""></a></span>
<span id="cb11-25"><a href=""></a>st.metric(<span class="st">"Expected number of passengers per trip"</span>, <span class="ss">f"</span><span class="sc">{</span>st<span class="sc">.</span>session_state[key]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb11-26"><a href=""></a></span>
<span id="cb11-27"><a href=""></a>st.write(<span class="ss">f"This page has run calculations </span><span class="sc">{</span>st<span class="sc">.</span>session_state<span class="sc">.</span>counter<span class="sc">}</span><span class="ss"> times. Session state keys (programmer tool, would not normally be shown to users):"</span>, <span class="bu">list</span>(st.session_state.keys()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- MS to GGG: can you add a "roadmap" to reviewing this code, similar to what you had above?  -->
</section>
<section id="what-is-a-session" class="slide level2" style="font-size: 0.8em">
<h2>What is a session?</h2>
<ul>
<li>A session is a single instance of viewing an app.</li>
<li>Multiple users = multiple sessions.</li>
<li>If the user refreshes their browser page or reloads the URL to the app, their Session State resets and they begin again with a new session.</li>
<li>Session State provides a dictionary-like interface where you can preserve info between script reruns. Use <code>st.session_state</code> with key or attribute notation to store and recall values. For example, <code>st.session_state.my_key</code>.</li>
</ul>
</section>
<section id="summary-1" class="slide level2">
<h2>summary</h2>
<ul>
<li>dashboards expect to be run more than once</li>
<li>bare mode lets you test running just once</li>
<li>when you run slow code, save the output</li>
<li>each browser tab is a session</li>
</ul>
</section></section>
<section>
<section id="decorators-and-cache_data" class="title-slide slide level1 center">
<h1>decorators and <code>@cache_data</code></h1>

</section>
<section id="roadmap-2" class="slide level2">
<h2>roadmap</h2>
<ul>
<li>decorator examples
<ul>
<li>timer</li>
<li>crs for spatial joins</li>
<li><code>@cache_data</code></li>
</ul></li>
<li>revisit toy example from last section</li>
<li>real-life example</li>
</ul>
</section>
<section id="timing-pandas-data-processing" class="slide level2">
<h2>Timing pandas data processing</h2>
<div id="ddb09a37" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href=""></a><span class="im">import</span> pandas <span class="im">as</span> pd, time</span>
<span id="cb12-2"><a href=""></a></span>
<span id="cb12-3"><a href=""></a><span class="kw">def</span> timer(func):</span>
<span id="cb12-4"><a href=""></a>    <span class="co">"""Decorator that prints runtime."""</span></span>
<span id="cb12-5"><a href=""></a>    <span class="kw">def</span> wrapper(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb12-6"><a href=""></a>        start <span class="op">=</span> time.time()</span>
<span id="cb12-7"><a href=""></a>        result <span class="op">=</span> func(<span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb12-8"><a href=""></a>        end <span class="op">=</span> time.time()</span>
<span id="cb12-9"><a href=""></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>func<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> took </span><span class="sc">{</span>end <span class="op">-</span> start<span class="sc">:.3f}</span><span class="ss"> s"</span>)</span>
<span id="cb12-10"><a href=""></a>        <span class="cf">return</span> result</span>
<span id="cb12-11"><a href=""></a>    <span class="cf">return</span> wrapper</span>
<span id="cb12-12"><a href=""></a></span>
<span id="cb12-13"><a href=""></a><span class="at">@timer</span></span>
<span id="cb12-14"><a href=""></a><span class="kw">def</span> summarize(df):</span>
<span id="cb12-15"><a href=""></a>    <span class="cf">return</span> df.groupby(<span class="st">"city"</span>)[<span class="st">"value"</span>].mean()</span>
<span id="cb12-16"><a href=""></a></span>
<span id="cb12-17"><a href=""></a>df <span class="op">=</span> pd.DataFrame({<span class="st">"city"</span>: [<span class="st">"SF"</span>,<span class="st">"NYC"</span>,<span class="st">"LA"</span>,<span class="st">"Chicago"</span>]<span class="op">*</span><span class="dv">3</span>, <span class="st">"value"</span>: <span class="bu">range</span>(<span class="dv">12</span>)})</span>
<span id="cb12-18"><a href=""></a>summary <span class="op">=</span> summarize(df)</span>
<span id="cb12-19"><a href=""></a>summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>summarize took 0.001 s</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>city
Chicago    7.0
LA         6.0
NYC        5.0
SF         4.0
Name: value, dtype: float64</code></pre>
</div>
</div>
<!-- MS to GGG: we should mention live that decorators are not a dashboard-only tool! As demonstrated by this slide's example and the next slide. And that we can write our own decorators, or use ones that come with a package (st.cache_data is the latter).-->
</section>
<section id="ensure-crs-for-geopandas-joins" class="slide level2">
<h2>Ensure CRS for GeoPandas joins</h2>
<div id="4304a2dd" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href=""></a><span class="im">import</span> geopandas <span class="im">as</span> gpd</span>
<span id="cb15-2"><a href=""></a></span>
<span id="cb15-3"><a href=""></a><span class="kw">def</span> ensure_crs(crs):</span>
<span id="cb15-4"><a href=""></a>    <span class="co">"""Ensure GeoDataFrames use the same CRS."""</span></span>
<span id="cb15-5"><a href=""></a>    <span class="kw">def</span> decorator(func): <span class="co">#unlike prior example, this decorator takes an arg</span></span>
<span id="cb15-6"><a href=""></a>        <span class="kw">def</span> wrapper(gdf1, gdf2, <span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb15-7"><a href=""></a>            <span class="cf">if</span> gdf1.crs <span class="op">!=</span> crs:</span>
<span id="cb15-8"><a href=""></a>                gdf1 <span class="op">=</span> gdf1.to_crs(crs)</span>
<span id="cb15-9"><a href=""></a>            <span class="cf">if</span> gdf2.crs <span class="op">!=</span> crs:</span>
<span id="cb15-10"><a href=""></a>                gdf2 <span class="op">=</span> gdf2.to_crs(crs)</span>
<span id="cb15-11"><a href=""></a>            <span class="cf">return</span> func(gdf1, gdf2, <span class="op">*</span>args, <span class="op">**</span>kwargs)</span>
<span id="cb15-12"><a href=""></a>        <span class="cf">return</span> wrapper</span>
<span id="cb15-13"><a href=""></a>    <span class="cf">return</span> decorator</span>
<span id="cb15-14"><a href=""></a></span>
<span id="cb15-15"><a href=""></a><span class="at">@ensure_crs</span>(<span class="st">"EPSG:4326"</span>) <span class="co">#center at 0 lat 0 lon</span></span>
<span id="cb15-16"><a href=""></a><span class="kw">def</span> spatial_join(gdf1, gdf2):</span>
<span id="cb15-17"><a href=""></a>    <span class="cf">return</span> gpd.sjoin(gdf1, gdf2, how<span class="op">=</span><span class="st">"inner"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="automate-toy-example-via-cache-ing" class="slide level2">
<h2>Automate toy example via cache-ing</h2>
<div id="81f85259" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href=""></a><span class="at">@st.cache_data</span></span>
<span id="cb16-2"><a href=""></a><span class="kw">def</span> long_running_function(param1, param2):</span>
<span id="cb16-3"><a href=""></a>    <span class="cf">return</span> ‚Ä¶</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>When user first calls <code>long_running_function(p1, p2)</code> for the first time, <code>@st.cache_data</code> makes a note of <code>p1, p2</code>. It stores the return value in a cache.</li>
<li>If the next call is <code>long_running_function(q1, q2)</code>, it also stores this in the cache.</li>
<li>(time-saving) If the next call is <code>long_running_function(p1, p2)</code>, instead of running any code, it just returns the saved value from the cache.</li>
</ol>
</section>
<section id="cache-data-in-streamlit" class="slide level2">
<h2>cache data in streamlit</h2>
<div id="4a882ce1" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href=""></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb17-2"><a href=""></a><span class="im">import</span> time</span>
<span id="cb17-3"><a href=""></a></span>
<span id="cb17-4"><a href=""></a></span>
<span id="cb17-5"><a href=""></a>st.set_page_config(page_title<span class="op">=</span><span class="st">"@cache_data"</span>)</span>
<span id="cb17-6"><a href=""></a>st.title(<span class="st">"Expensive Calculation Demo"</span>)</span>
<span id="cb17-7"><a href=""></a></span>
<span id="cb17-8"><a href=""></a><span class="co"># user inputs</span></span>
<span id="cb17-9"><a href=""></a>route <span class="op">=</span> st.selectbox(<span class="st">"CTA route to cut"</span>, [<span class="st">"Red Line"</span>, <span class="st">"Blue Line"</span>, <span class="st">"Green Line"</span>])</span>
<span id="cb17-10"><a href=""></a>cut_pct <span class="op">=</span> st.slider(<span class="st">"What fraction of service to cut?"</span>, <span class="fl">0.0</span>, <span class="fl">50.0</span>, <span class="fl">10.0</span>, step<span class="op">=</span><span class="fl">5.0</span>)</span>
<span id="cb17-11"><a href=""></a></span>
<span id="cb17-12"><a href=""></a><span class="cf">if</span> <span class="st">"counter"</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb17-13"><a href=""></a>    st.session_state.counter <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-14"><a href=""></a></span>
<span id="cb17-15"><a href=""></a><span class="at">@st.cache_data</span>()</span>
<span id="cb17-16"><a href=""></a><span class="kw">def</span> compute_passengers(route, cut_pct):</span>
<span id="cb17-17"><a href=""></a>    <span class="cf">with</span> st.spinner(<span class="st">"Crunching numbers..."</span>):</span>
<span id="cb17-18"><a href=""></a>        time.sleep(<span class="dv">3</span>)  <span class="co"># stand-in for a slow computation</span></span>
<span id="cb17-19"><a href=""></a>    st.session_state.counter <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb17-20"><a href=""></a>    <span class="cf">return</span> (<span class="dv">100</span> <span class="op">-</span> cut_pct) <span class="op">*</span> <span class="fl">1.2345</span>  <span class="co"># fake result</span></span>
<span id="cb17-21"><a href=""></a>expected_passengers <span class="op">=</span> compute_passengers(route, cut_pct)</span>
<span id="cb17-22"><a href=""></a></span>
<span id="cb17-23"><a href=""></a>st.metric(<span class="st">"Expected number of passengers per trip"</span>, expected_passengers)</span>
<span id="cb17-24"><a href=""></a></span>
<span id="cb17-25"><a href=""></a>st.write(<span class="ss">f"This page has run calculations </span><span class="sc">{</span>st<span class="sc">.</span>session_state<span class="sc">.</span>counter<span class="sc">}</span><span class="ss"> times."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="http://uchicago-harris-dap-dashboards-6.streamlit.app/">http://uchicago-harris-dap-dashboards-6.streamlit.app/</a></p>
</section>
<section id="revisit-a-real-example-4uber_pickups.py" class="slide level2">
<h2>Revisit a real example: <code>4/uber_pickups.py</code></h2>
<p>We have decorated <code>@st.cache_data</code> for four different functions</p>
<ol type="1">
<li><code>load_data()</code></li>
<li><code>filterdata(data, hour_selected)</code></li>
<li><code>mpoint()</code></li>
<li><code>histdata()</code></li>
</ol>
</section>
<section id="summary-what-all-decorators-have-in-common" class="slide level2" style="font-size: 0.8em">
<h2>Summary: What all decorators have in common</h2>
<ul>
<li>All wrap a function with extra behavior.</li>
<li>They take a function as input and return a modified version.</li>
<li>Create them when you know you will use an <strong>already-written</strong> function more than once</li>
<li>Syntax: <code>@decorator</code> above a function definition.</li>
<li>Examples
<ul>
<li>Timing and logging (<code>@timer</code>)</li>
<li>Validation or transformation (<code>@ensure_crs(crs)</code>)</li>
<li>Caching (<code>@st.cache_data</code>)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="streamlit-and-other-types-of-dashboards" class="title-slide slide level1 center" style="font-size: 0.8em">
<h1>Streamlit and other types of dashboards</h1>

</section>
<section id="roadmap-3" class="slide level2">
<h2>Roadmap</h2>
<ul>
<li>Tips for streamlit</li>
<li>Tips for final project</li>
<li>Streamlit vs other dashboarding software</li>
<li>Promise and pitfalls of dashboards revisited</li>
</ul>
</section>
<section id="streamlit-tips" class="slide level2">
<h2>Streamlit Tips</h2>
<ul>
<li>Lay out your editor and browser windows side by side, so the code and the app can be seen at the same time.</li>
<li>Your main script should live in a directory other than the root directory.</li>
<li><a href="https://docs.streamlit.io/develop/quick-reference/cheat-sheet">https://docs.streamlit.io/develop/quick-reference/cheat-sheet</a></li>
</ul>
</section>
<section id="other-streamlit-applications-we-will-not-cover-examples-on-the-streamlit-website" class="slide level2">
<h2>Other Streamlit applications we will not cover (examples on the streamlit website)</h2>
<ul>
<li>Chat box / LLM wrapper</li>
<li>Draw on external data (user uploaded, from a live database, etc.)</li>
</ul>
</section>
<section id="how-should-you-use-streamlit-for-the-final-project-and-in-life" class="slide level2">
<h2>How should you use streamlit for the final project (and in life)?</h2>
<ul>
<li>Build a dashboard when a static figure or table will not suffice</li>
<li>This occurs when there is too much information to fit on a single figure or table (e.g.&nbsp;one dashboard is better than ten figures)</li>
<li>The goal, however, is not to proliferate information (e.g.&nbsp;‚Äúhow can I imagine ten figures so that then I can shoehorn them into dashboard?‚Äù).</li>
<li>Instead, it is to develop a set of information that a reader or decision-maker would want to interact with.</li>
</ul>
</section>
<section id="streamlit-and-other-dashboarding-tools" class="slide level2" style="font-size: 0.8em">
<h2>Streamlit and other dashboarding tools</h2>
<p>Streamlit is not in the top 10 of most commonly-used dashboards.</p>
<p>What software might you see elsewhere? Microsoft Power BI, tableau, Qlik, Looker, SAP, plotly, shiny</p>
<p>What dashboard should you use? This is not an important choice. Use whatever your organization or collaborators are already using. Or prototype in streamlit and then port.</p>
<p>What if a job you apply for requires a specific dashboarding software? Spend a few hours teaching it to yourself and then put it on your resume (do <strong>not</strong> just put it on your resume). Or put dashbaords in general and learn the skill for the interview.</p>
</section>
<section id="the-most-famous-dashboard-ever" class="slide level2" style="font-size: 0.8em">
<h2>The most famous dashboard ever</h2>
<p>New York City Police Department‚Äôs ‚ÄúCompStat‚Äù in the 1990‚Äôs. Why is it such a perfect application of a dashboard? (Source: <em>Classic book: Bob Behn‚Äôs The PerformanceStat Potential</em>)</p>
<!-- MS to GGG: add link/illustrative screenshot? -->
<!-- note to self: I skipped 4 and 7 since I didn't think they make a lot of sense-->
<ol type="1">
<li>Metrics (arrests, crime rate) are clearly aligned with institutional goals</li>
<li>Data are automatically collected daily</li>
<li>Historical baseline data are available</li>
<li>Focused efforts can produce immediate results</li>
<li>All police commanders start as beat cops</li>
<li>Multiple subunits facilitate comparison</li>
<li>Size plus managerial discretion creates personnel flexibility</li>
</ol>
<p>Very few other parts of government can meet all seven of these criteria</p>
</section>
<section id="skeptic" class="slide level2">
<h2>Skeptic</h2>
<p>Even under these perfect conditions, the dashboard was not very successful. In a survey of 1800 retired NYC police officers of the question ‚Äúare you confident that major crimes have declined by 80% in New York since 1990s?‚Äù more than half said no (Eterno, Verma, and Silverman 2014). Respondents also talked about pressure to change reports to make crime look better.</p>
<p>The key idea is that ‚Äúwhat gets measured gets managed‚Äù. Once a manger focuses on a metric, that metric becomes less useful or informative than it was before.</p>
</section>
<section id="conclusion-of-section" class="slide level2">
<h2>Conclusion of section</h2>
<ul>
<li>Streamlit is an amazing tool</li>
<li>The key skill, however, is not streamlit, it is organizing information for an external analyst or decision-maker.</li>
<li>Dashboards have real downsides</li>
<li>In spite of these downsides, dashboards continue to grow in popularity</li>
</ul>
</section>
<section id="do-pair-share-stub" class="slide level2">
<h2>Do-pair-share stub</h2>
<p><code>$ streamlit run world_map.py</code></p>
<p>Plot agricultural production on a map of the world Will ask students to set up a slider to choose the year</p>
</section>
<section id="backup-altair-troubleshooting" class="slide level2">
<h2>Backup: Altair troubleshooting</h2>
<ul>
<li>It is possible to have Altair installed (as captured by <code>pip show altair</code>) but also have <code>import altair</code> fail on mac with a chip architecture error: <code>have 'x86_64', need 'arm64e' or 'arm64')</code></li>
<li>Didn‚Äôt work: make a new <code>venv</code> or update Python.</li>
<li>Worked: <code>pip install --force-reinstall --no-cache-dir --only-binary=:all: rpds-py</code></li>
</ul>
</section>
<section id="backup-altair-troubleshooting-1" class="slide level2">
<h2>Backup: Altair troubleshooting</h2>
<p>‚ÄúThis is a compatibility issue between the package‚Äôs [altair‚Äôs] generated schema and Python 3.14.‚Äù</p>
<p>Solution: downgrade to Python 3.12.</p>
</section>
<section id="backup-streamlit-troubleshooting" class="slide level2">
<h2>Backup: Streamlit troubleshooting</h2>
<p>Make sure that your virtual environment is active!</p>
<p>urllib.error.URLError: &lt;urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1000)&gt;</p>
<p>Solution Find your Python‚Äôs ‚ÄúInstall Certificates.command‚Äù in Finder: 1. Open&nbsp;/Applications. 2. Enter the folder for your Python (for example&nbsp;Python 3.11). 3. Double-click&nbsp;Install Certificates.command.</p>
<!--

## do-pair-share
$ pip install streamlit watchdog
-->

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="dashboards_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="dashboards_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="dashboards_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="dashboards_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>